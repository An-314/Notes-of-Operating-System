#import "@preview/scripst:1.1.1": *

= è™šæ‹Ÿå­˜å‚¨ç®¡ç†

== è™šæ‹Ÿå­˜å‚¨æ¦‚å¿µ

#note(subname: [é—®é¢˜])[
  å¦‚ä½•è¿è¡Œä»£ç å ç”¨ç©ºé—´å¤§äºç‰©ç†å†…å­˜çš„ç¨‹åºï¼Ÿ
  - é—®é¢˜ï¼š
    - ç¨‹åºå¤ªå¤§ï¼Œè£…ä¸ä¸‹
    - ç¨‹åºå„éƒ¨åˆ†ä½¿ç”¨é¢‘ç‡ä¸åŒï¼Œæœ‰çš„å¸¸ç”¨ï¼Œæœ‰çš„å‡ ä¹ä¸ç”¨
    - å¦‚æœèƒ½â€œåªæŠŠéœ€è¦çš„éƒ¨åˆ†æ”¾è¿›å†…å­˜â€ï¼Œå°±èƒ½èŠ‚çœç©ºé—´
  - æˆ‘ä»¬å¸Œæœ›ï¼š
    - ç¨‹åºåœ¨è¿è¡Œæ—¶ä¸éœ€è¦å®Œå…¨åŠ è½½è¿›ç‰©ç†å†…å­˜
    - åªåœ¨éœ€è¦è®¿é—®æŸä¸€éƒ¨åˆ†æ—¶ï¼Œæ‰åŠ è½½å¯¹åº”é¡µ
    - å½“ç‰©ç†å†…å­˜ä¸å¤Ÿæ—¶ï¼ŒæŠŠæš‚æ—¶ä¸ç”¨çš„é¡µæ¢å‡ºå»
  - è¿™å°±æ˜¯*è™šæ‹Ÿå­˜å‚¨ï¼ˆVirtual Memoryï¼‰*çš„æ€æƒ³
  è™šæ‹Ÿå­˜å‚¨çš„æ ¸å¿ƒç†å¿µ
  - ç”¨ç£ç›˜ï¼ˆå¤–å­˜ï¼‰æ‰©å±•å†…å­˜å®¹é‡ï¼Œè®©ç¨‹åºâ€œä»¥ä¸ºâ€å®ƒåœ¨è®¿é—®ä¸€ä¸ªå·¨å¤§çš„å†…å­˜ç©ºé—´
  - æ“ä½œç³»ç»Ÿé€šè¿‡*è™šæ‹Ÿå†…å­˜é¡µè¡¨ + ç¼ºé¡µä¸­æ–­æœºåˆ¶*å®ç°è¿™ä¸€ç‚¹
    #three-line-table[
      | å±‚æ¬¡            | å­˜å‚¨ä»‹è´¨  | é€Ÿåº¦ | å®¹é‡    | æ˜¯å¦å¯å¯»å€   |
      | ------------- | ----- | -- | ----- | ------- |
      | L1/L2 Cache   | CPUå†…éƒ¨ | æå¿« | KBçº§   | å¦ï¼ˆç¡¬ä»¶é€æ˜ï¼‰ |
      | å†…å­˜ (RAM)      | DRAM  | å¿«  | MB~GB | å¯å¯»å€   |
      | ç£ç›˜ (Disk/SSD) | å¤–å­˜    | æ…¢  | GB~TB | å¯å¯»å€   |
    ]
  - è™šæ‹Ÿå†…å­˜ï¼ˆVMï¼‰å°±æ˜¯æŠŠ RAM + ç£ç›˜çš„ä¸€éƒ¨åˆ†ï¼ˆSwap æˆ– Page Fileï¼‰ç»Ÿä¸€æŠ½è±¡æˆä¸€ä¸ªâ€œå·¨å¤§çš„é€»è¾‘å†…å­˜â€
  è™šæ‹Ÿå­˜å‚¨ç³»ç»Ÿçš„å…³é”®æœºåˆ¶
  - å®ç°â€œè™šæ‹Ÿå­˜å‚¨â€éœ€è¦æ“ä½œç³»ç»Ÿ + ç¡¬ä»¶çš„å…±åŒæ”¯æŒï¼š
    #three-line-table[
      | æœºåˆ¶                           | è¯´æ˜                   |
      | ---------------------------- | -------------------- |
      | *é¡µè¡¨ (Page Table)*          | å»ºç«‹è™šæ‹Ÿé¡µä¸ç‰©ç†é¡µã€å¤–å­˜é¡µä¹‹é—´çš„æ˜ å°„å…³ç³» |
      | *ç¼ºé¡µä¸­æ–­ (Page Fault)*        | å½“è®¿é—®çš„è™šæ‹Ÿé¡µä¸åœ¨å†…å­˜ä¸­æ—¶è§¦å‘ä¸­æ–­    |
      | *é¡µé¢ç½®æ¢ (Page Replacement)*  | ä»å†…å­˜ä¸­æ¢å‡ºæ—§é¡µï¼ŒæŠŠæ–°é¡µè°ƒå…¥       |
      | *ç£ç›˜äº¤æ¢åŒº (Swap / Page File)* | å­˜æ”¾è¢«æ¢å‡ºçš„é¡µå†…å®¹            |
    ]
  æ•´ä½“å·¥ä½œæµç¨‹ï¼š
  - ç¨‹åºè®¿é—®ä¸€ä¸ªè™šæ‹Ÿåœ°å€ï¼ˆVAï¼‰
  - ç¡¬ä»¶ï¼ˆMMUï¼‰æŸ¥é¡µè¡¨ï¼š
    - è‹¥é¡µè¡¨ä¸­æ ‡è®°ä¸ºâ€œå­˜åœ¨ (Present=1)â€ï¼Œç›´æ¥è®¿é—®ç‰©ç†é¡µ
    - è‹¥æ ‡è®°ä¸ºâ€œä¸åœ¨å†…å­˜ (Present=0)â€ï¼Œè§¦å‘ç¼ºé¡µå¼‚å¸¸
  - ç¼ºé¡µå¼‚å¸¸å¤„ç†ç¨‹åºï¼š
    - OS æŸ¥æ‰¾è¯¥é¡µåœ¨ç£ç›˜ä¸­çš„ä½ç½®
    - åˆ†é…ä¸€ä¸ªç©ºé—²ç‰©ç†é¡µ
    - æŠŠè¯¥é¡µå†…å®¹ä»ç£ç›˜è¯»å…¥
    - æ›´æ–°é¡µè¡¨é¡¹ï¼ˆè®¾ä¸º Present=1ï¼‰
    - é‡æ–°æ‰§è¡ŒæŒ‡ä»¤
  - è‹¥å†…å­˜å·²æ»¡ï¼Œå…ˆæ‰§è¡Œé¡µé¢ç½®æ¢ç®—æ³•ï¼ˆLRU / FIFO / Clockï¼‰
  è™šæ‹Ÿå­˜å‚¨çš„ä¸‰å±‚æ˜ å°„å…³ç³»
  - åœ¨è™šæ‹Ÿå­˜å‚¨ç³»ç»Ÿä¸­ï¼Œä¸€ä¸ªè™šæ‹Ÿé¡µï¼ˆVPNï¼‰å¯èƒ½æœ‰ä¸‰ç§çŠ¶æ€ï¼š
    #three-line-table[
      | çŠ¶æ€                          | å­˜æ”¾ä½ç½®     | é¡µè¡¨ä¸­çš„æ ‡å¿—           | è¡Œä¸º           |
      | --------------------------- | -------- | ---------------- | ------------ |
      | *é©»ç•™é¡µ (Resident Page)*     | å·²åŠ è½½åˆ°å†…å­˜   | Present=1        | å¯ç›´æ¥è®¿é—®        |
      | *æ¢å‡ºé¡µ (Swapped-out Page)*  | å­˜æ”¾åœ¨ç£ç›˜äº¤æ¢åŒº | Present=0, æœ‰ç£ç›˜åœ°å€ | è§¦å‘ç¼ºé¡µæ—¶æ¢å…¥      |
      | *æœªåˆ†é…é¡µ (Unallocated Page)* | å°šæœªåˆ†é…     | é¡µè¡¨é¡¹æ— æ•ˆ            | è®¿é—®æ—¶æŠ¥é”™ï¼ˆä¾‹å¦‚æ®µé”™è¯¯ï¼‰ |
    ]
  è™šæ‹Ÿå­˜å‚¨ä¸åˆ†é¡µæœºåˆ¶çš„å…³ç³»
  - åˆ†é¡µæœºåˆ¶è§£å†³çš„æ˜¯ï¼šâ€œè™šæ‹Ÿåœ°å€ â†’ ç‰©ç†åœ°å€â€çš„é™æ€æ˜ å°„é—®é¢˜
  - è™šæ‹Ÿå­˜å‚¨è¿›ä¸€æ­¥æ‰©å±•æˆï¼šâ€œè™šæ‹Ÿåœ°å€ â†’ ï¼ˆç‰©ç†åœ°å€ æˆ– ç£ç›˜åœ°å€ï¼‰â€çš„åŠ¨æ€æ˜ å°„é—®é¢˜
  å¸¸è§è™šæ‹Ÿå­˜å‚¨å®ç°æ–¹å¼
  - #three-line-table[
      | ç³»ç»Ÿ                | è™šæ‹Ÿå­˜å‚¨æœºåˆ¶            | ç‰¹ç‚¹          |
      | ----------------- | ----------------- | ----------- |
      | *Linux / Unix*  | Swap + Page Cache | é¡µç²’åº¦æ¢å…¥æ¢å‡º     |
      | *Windows*       | Pagefile.sys      | ç³»ç»Ÿè‡ªåŠ¨ç®¡ç†å¤§å°    |
      | *macOS*         | Unified VM System | åŠ¨æ€å‹ç¼© + äº¤æ¢æ–‡ä»¶ |
      | *rCore / uCore* | æ•™å­¦å®éªŒæ€§ VM          | ä»…å®ç°é¡µçº§æ¢å…¥æ¢å‡ºé€»è¾‘ |
    ]
  å¦‚ä½•è¿è¡Œä»£ç å ç”¨ç©ºé—´å¤§äºç‰©ç†å†…å­˜çš„ç¨‹åºï¼Ÿ
  - ä½¿ç”¨ æŒ‰éœ€åˆ†é¡µ (Demand Paging)ï¼ŒåªåŠ è½½å½“å‰éœ€è¦çš„é¡µ
  å¦‚ä½•åˆ¤æ–­éœ€è¦æ‰§è¡Œçš„ä»£ç æ˜¯å¦åœ¨å†…å­˜ä¸­ï¼Ÿ
  - é¡µè¡¨é¡¹ä¸­çš„å­˜åœ¨ä½ï¼ˆPresent bitï¼‰å‘Šè¯‰ CPU è¯¥é¡µæ˜¯å¦é©»ç•™å†…å­˜
  å½“ä»£ç ä¸åœ¨å†…å­˜æ—¶ï¼Œå¦‚ä½•æŠŠå®ƒæ¬å›æ¥ï¼Ÿ
  - é€šè¿‡ ç¼ºé¡µä¸­æ–­ + é¡µé¢ç½®æ¢ + äº¤æ¢åŒºï¼Œç”±å†…æ ¸å®Œæˆè‡ªåŠ¨è°ƒå…¥
]

=== è™šæ‹Ÿå­˜å‚¨æŠ€æœ¯çš„éœ€æ±‚

*è™šæ‹Ÿå­˜å‚¨æŠ€æœ¯çš„éœ€æ±‚èƒŒæ™¯*
- ç¨‹åºè§„æ¨¡çš„å¢é•¿é€Ÿåº¦è¿œå¤§äºå­˜å‚¨å™¨å®¹é‡çš„å¢é•¿é€Ÿåº¦
- æŒ‘æˆ˜ï¼šè®¡ç®—æœºç³»ç»Ÿæ—¶å¸¸å‡ºç°å†…å­˜ä¸å¤Ÿç”¨
- æ€è·¯ï¼šå†…å­˜ä¸å¤Ÿï¼Œå¤–å­˜æ¥è¡¥
  - å‡½æ•°è¦†ç›–ï¼ˆoverlayï¼‰
    - åº”ç”¨ç¨‹åºä»¥å‡½æ•°/æ¨¡å—ä¸ºå•ä½æ‰‹åŠ¨æ¢å…¥æ¢å‡ºå†…å­˜
  - ç¨‹åºäº¤æ¢ï¼ˆswappingï¼‰
    - æ“ä½œç³»ç»Ÿä»¥ç¨‹åºä¸ºå•ä½è‡ªåŠ¨æ¢å…¥æ¢å‡ºå†…å­˜
  - è™šæ‹Ÿå­˜å‚¨(virtual storage)
    - æ“ä½œç³»ç»Ÿä»¥é¡µä¸ºå•ä½è‡ªåŠ¨æ¢å…¥æ¢å‡ºå†…å­˜
    - è™šæ‹Ÿå­˜å‚¨=å†…å­˜+å¤–å­˜

*åœ°å€ç©ºé—´ï¼šæ“ä½œç³»ç»Ÿçš„æŠ½è±¡å±‚*
- åœ°å€ç©ºé—´ï¼ˆAddress Spaceï¼‰æ˜¯ OS å¯¹è™šæ‹Ÿå­˜å‚¨çš„ç»Ÿä¸€æŠ½è±¡
- æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ç‹¬ç«‹çš„åœ°å€ç©ºé—´
- æ¯ä¸ªåœ°å€ç©ºé—´éƒ½ç”±é¡µè¡¨æè¿°
- OS è´Ÿè´£åœ¨ç‰©ç†å†…å­˜ä¸ç£ç›˜é—´åŠ¨æ€è°ƒåº¦é¡µ
- å¯¹è¿›ç¨‹æ¥è¯´ï¼Œå®ƒâ€œçœ‹åˆ°â€çš„åœ°å€ç©ºé—´æ˜¯è¿ç»­ä¸”å®Œæ•´çš„
- å®é™…ä¸Šï¼Œå®ƒåªåœ¨å†…å­˜ä¸­é©»ç•™äº†å°‘é‡â€œæ´»è·ƒé¡µâ€
  #figure(
    image("pic/2025-10-23-19-27-07.png", width: 80%),
    numbering: none,
  )
  - ä¸Šå±‚ï¼ˆP1ã€P2ã€P3ã€å†…æ ¸ï¼‰
    - æ¯ä¸ªè¿›ç¨‹çœ‹åˆ°çš„è™šæ‹Ÿåœ°å€ç©ºé—´éƒ½æ˜¯å®Œæ•´çš„ã€ç‹¬ç«‹çš„ã€0ï½2Â³Â²âˆ’1ï¼š
      - è™šæ‹Ÿåœ°å€ç©ºé—´ç›¸äº’ç‹¬ç«‹
      - å„è‡ªéƒ½æœ‰ä»£ç æ®µã€æ•°æ®æ®µã€æ ˆæ®µ
      - ä½†è¿™äº›è™šæ‹Ÿåœ°å€å®é™…æ˜ å°„åˆ°ä¸åŒçš„ç‰©ç†é¡µ
    - è¿™å°±æ˜¯â€œåœ°å€ç©ºé—´éš”ç¦»â€çš„å®ç°
  - ä¸­å±‚ï¼ˆRAMï¼Œç‰©ç†å†…å­˜ï¼‰
    - è¿™æ˜¯çœŸæ­£çš„ DRAMï¼Œå®¹é‡ä¸º mï¼ˆè¿œå°äºæ€»éœ€æ±‚ Mï¼‰
      - MMUï¼ˆå†…å­˜ç®¡ç†å•å…ƒï¼‰é€šè¿‡é¡µè¡¨ï¼Œå†³å®šå“ªäº›è™šæ‹Ÿé¡µå½“å‰åœ¨å†…å­˜
      - å¦‚æœè®¿é—®çš„é¡µä¸åœ¨å†…å­˜ï¼ŒMMU ä¼šè§¦å‘â€œç¼ºé¡µä¸­æ–­â€
      - å†…æ ¸ä¼šä»å¤–å­˜æŠŠè¯¥é¡µè°ƒå…¥å†…å­˜
  - ä¸‹å±‚ï¼ˆç£ç›˜/SSDï¼Œå¤–å­˜ï¼‰
    - å®¹é‡ä¸º M â‰« m
    - å­˜æ”¾è¢«æ¢å‡ºçš„é¡µï¼ˆä¹Ÿå«äº¤æ¢åŒº Swap Spaceï¼‰
    - æ¯ä¸ªé¡µåœ¨ç£ç›˜ä¸­éƒ½æœ‰ä¸€ä¸ªå¯¹åº”çš„â€œå¤‡ä»½ä½ç½®â€

=== è¦†ç›–æŠ€æœ¯

*è¦†ç›–æŠ€æœ¯*
- ç›®æ ‡
  - ç¨‹åºå‘˜*æ‰‹åŠ¨æ§åˆ¶*åœ¨*è¾ƒå°çš„å¯ç”¨å†…å­˜*ä¸­è¿è¡Œ*è¾ƒå¤§çš„ç¨‹åº*
- åŸºæœ¬æ€è·¯
  - *ä¸åŒæ—¶é—´æ®µ*å†…æ‰§è¡Œçš„*å‡½æ•°æˆ–æ¨¡å—*å…±äº«ä¸€å—æœ‰é™çš„ç©ºé—´
  - æŠŠç¨‹åºåˆ’åˆ†æˆè‹¥å¹²æ¨¡å—ï¼ŒåªæŠŠå½“å‰éœ€è¦æ‰§è¡Œçš„æ¨¡å—è£…å…¥å†…å­˜ï¼Œä¸åŒæ—¶é—´æ‰§è¡Œçš„æ¨¡å—å¯ä»¥å…±ç”¨åŒä¸€å—å†…å­˜åŒºåŸŸ

*è¦†ç›–çš„åŸºæœ¬åŸç†*
- è¦†ç›–æ˜¯æŒ‡æŠŠä¸€ä¸ªç¨‹åº*åˆ’åˆ†*ä¸ºä¸€ç³»åˆ—åŠŸèƒ½ç›¸å¯¹ç‹¬ç«‹çš„ç¨‹åºæ®µï¼Œè®©æ‰§è¡Œæ—¶*ä¸è¦æ±‚åŒæ—¶è£…å…¥å†…å­˜*çš„ç¨‹åºæ®µç»„æˆä¸€ç»„ï¼ˆç§°ä¸ºè¦†ç›–æ®µï¼‰ï¼Œ*å…±äº«*ä¸»å­˜çš„åŒä¸€ä¸ªåŒºåŸŸ
  - å¿…è¦éƒ¨åˆ†ï¼ˆå¸¸ç”¨ï¼‰çš„ä»£ç å’Œæ•°æ®å¸¸é©»å†…å­˜
  - å¯é€‰éƒ¨åˆ†ï¼ˆä¸å¸¸ç”¨ï¼‰æ”¾åœ¨å…¶ä»–ç¨‹åºæ¨¡å—ä¸­ï¼Œåªåœ¨éœ€è¦æ—¶è£…å…¥å†…å­˜
  - ä¸å­˜åœ¨è°ƒç”¨å…³ç³»çš„æ¨¡å—å¯ç›¸äº’è¦†ç›–ï¼Œå…±ç”¨åŒä¸€å—å†…å­˜åŒºåŸŸ
- ç¨‹åºåˆ†æ®µ
  - ç¨‹åºè¢«åˆ’åˆ†ä¸ºè‹¥å¹²ç‹¬ç«‹åŠŸèƒ½æ¨¡å—ï¼ˆç§°ä¸ºâ€œè¦†ç›–æ®µâ€ï¼‰ã€‚
- å¸¸é©»åŒº + è¦†ç›–åŒº
  - å¸¸é©»åŒºï¼šå§‹ç»ˆåœ¨å†…å­˜ä¸­ï¼ˆå¦‚ä¸»æ§æ¨¡å—ã€è°ƒåº¦æ¨¡å—ï¼‰
  - è¦†ç›–åŒºï¼šæŒ‰éœ€è£…å…¥çš„æ¨¡å—åŒº
- è¦†ç›–å…³ç³»
  - ä¸ä¼šåŒæ—¶æ‰§è¡Œçš„æ¨¡å—å…±äº«åŒä¸€ä¸ªå†…å­˜åŒºåŸŸ

*è¦†ç›–æŠ€æœ¯ç¤ºä¾‹*
- ç¨‹åºè°ƒç”¨ç»“æ„
  ```
  A(20K)
  â”œâ”€â”€ B(50K)
  â”‚   â””â”€â”€ D(30K)
  â””â”€â”€ C(30K)
      â”œâ”€â”€ E(20K)
      â””â”€â”€ F(40K)
  ```
  - æ•´ä¸ªç¨‹åºå¤§å°æ€»è®¡ï¼š190K
  - ä½†è®¡ç®—æœºå†…å­˜åªæœ‰ 110K
- è¦†ç›–åˆ†åŒºè®¾è®¡æ–¹æ¡ˆ
  #three-line-table[
    | åŒºåŸŸ    | å†…å®¹       | å ç”¨  | ç‰¹ç‚¹     |
    | ----- | -------- | --- | ------ |
    | å¸¸é©»åŒº   | A æ¨¡å—     | 20K | å§‹ç»ˆåœ¨å†…å­˜ä¸­ |
    | è¦†ç›–åŒº 0 | Bã€Eã€F å…±ç”¨ | 50K | ä¸ä¼šåŒæ—¶æ‰§è¡Œ |
    | è¦†ç›–åŒº 1 | Cã€D å…±ç”¨   | 30K | ä¸ä¼šåŒæ—¶æ‰§è¡Œ |
  ]
*è¦†ç›–çš„è¿è¡Œæœºåˆ¶*
- å½“ç¨‹åºæ‰§è¡Œéœ€è¦è¿›å…¥æŸä¸ªæœªåœ¨å†…å­˜çš„æ¨¡å—æ—¶ï¼š
  - ç¨‹åºå‘å‡ºâ€œè£…å…¥æ¨¡å— Xâ€çš„è¯·æ±‚
  - æ“ä½œç³»ç»Ÿä»å¤–å­˜ä¸­è¯»å–æ¨¡å— X åˆ°æŒ‡å®šè¦†ç›–åŒº
  - è‹¥è¯¥åŒºå·²æœ‰æ¨¡å—ï¼Œåˆ™å°†å…¶å†…å®¹è¦†ç›–æ‰
  - ç¨‹åºè·³è½¬åˆ°æ¨¡å— X çš„å…¥å£ç»§ç»­æ‰§è¡Œ
- è¿™å°±æ˜¯ â€œæ—¶é—´æ¢ç©ºé—´â€ çš„æ‰‹æ®µ

*è¦†ç›–æŠ€æœ¯çš„ä¸è¶³*
- å¢åŠ ç¼–ç¨‹å›°éš¾
  - éœ€ç¨‹åºå‘˜åˆ’åˆ†åŠŸèƒ½æ¨¡å—ï¼Œå¹¶ç¡®å®šæ¨¡å—é—´çš„è¦†ç›–å…³ç³»
  - å¢åŠ äº†ç¼–ç¨‹çš„å¤æ‚åº¦
    - Turbo Pascalçš„Overlayç³»ç»Ÿå•å…ƒæ”¯æŒç¨‹åºå‘˜æ§åˆ¶çš„è¦†ç›–æŠ€æœ¯
- å¢åŠ æ‰§è¡Œæ—¶é—´
  - ä»å¤–å­˜è£…å…¥è¦†ç›–æ¨¡å—
  - æ—¶é—´æ¢ç©ºé—´

=== äº¤æ¢æŠ€æœ¯

*äº¤æ¢æŠ€æœ¯*
- åŸºæœ¬æ€è·¯
  - æ“ä½œç³»ç»Ÿä»¥*ç¨‹åº*ä¸ºå•ä½*è‡ªåŠ¨*æ¢å…¥æ¢å‡ºå†…å­˜
- æ–¹æ³•
  - *æ¢å‡º(swap out)*ï¼šæŠŠä¸€ä¸ªæ‰§è¡Œç¨‹åºçš„æ•´ä¸ªåœ°å€ç©ºé—´å†…å®¹ä¿å­˜åˆ°å¤–å­˜
  - *æ¢å…¥(swap in)*ï¼šå°†å¤–å­˜ä¸­æŸæ‰§è¡Œç¨‹åºçš„åœ°å€ç©ºé—´å†…å®¹è¯»å…¥åˆ°å†…å­˜

*äº¤æ¢æŠ€æœ¯é¢ä¸´çš„é—®é¢˜*
- äº¤æ¢*æ—¶æœº*ï¼šä½•æ—¶éœ€è¦å‘ç”Ÿäº¤æ¢ï¼Ÿ
  - åªå½“å†…å­˜ç©ºé—´ä¸å¤Ÿæˆ–æœ‰ä¸å¤Ÿçš„å¯èƒ½æ—¶æ¢å‡º
- ç¨‹åºæ¢å…¥æ—¶çš„*é‡å®šä½*ï¼šæ¢å‡ºåå†æ¢å…¥æ—¶è¦æ”¾åœ¨åŸå¤„å—ï¼Ÿ
  - ä¸ä¸€å®šåœ¨åŸå¤„ï¼Œéœ€è¦æŸç§æœºåˆ¶ä¿è¯ç¨‹åºæ­£ç¡®å¯»å€&æ‰§è¡Œ
- äº¤æ¢åŒºï¼ˆç©ºé—´ï¼‰å¤§å°
  - ç»éªŒå€¼ã€‚ä¸‹é¢æ˜¯Linuxä¸“å®¶ç»™å‡ºçš„å»ºè®®
    #three-line-table[
      | ç‰©ç†å†…å­˜       | å»ºè®®çš„äº¤æ¢ç©ºé—´ | å¯ç”¨ä¼‘çœ æ—¶å»ºè®®   |
      | ---------- | ------- | --------- |
      | â‰¤ 2GB      | å†…å­˜çš„ 2 å€ | å†…å­˜çš„ 3 å€   |
      | 2GB â€“ 8GB  | ç­‰äºå†…å­˜å¤§å°  | å†…å­˜çš„ 2 å€   |
      | 8GB â€“ 64GB | è‡³å°‘ 4GB  | å†…å­˜çš„ 1.5 å€ |
      | > 64GB     | è‡³å°‘ 4GB  | ä¸å»ºè®®ä¼‘çœ      |
    ]

*è¦†ç›–ä¸äº¤æ¢çš„æ¯”è¾ƒ*
- #three-line-table[
    | å¯¹æ¯”ç»´åº¦     | è¦†ç›–æŠ€æœ¯ (Overlay) | äº¤æ¢æŠ€æœ¯ (Swapping) |
    | -------- | -------------- | --------------- |
    | æ¢å…¥æ¢å‡ºå•ä½   | æ¨¡å— / å‡½æ•°        | æ•´ä¸ªç¨‹åºï¼ˆè¿›ç¨‹ï¼‰        |
    | è§¦å‘æ–¹å¼     | ç¨‹åºå‘˜æ‰‹åŠ¨          | æ“ä½œç³»ç»Ÿè‡ªåŠ¨          |
    | æ˜¯å¦éœ€è¦ç¨‹åºåˆ’åˆ† | âœ… éœ€è¦           | âŒ ä¸éœ€è¦           |
    | è°ƒåº¦ç²’åº¦     | æ¨¡å—çº§            | è¿›ç¨‹çº§             |
    | æ˜¯å¦æ”¯æŒå¹¶å‘ç¨‹åº | âŒ å¦            | âœ… æ˜¯             |
    | æ—¶é—´æˆæœ¬     | ç¨‹åº I/O è¾ƒå°‘      | æ•´ä¸ªç¨‹åº I/Oï¼Œå¼€é”€æ›´å¤§   |
    | ç©ºé—´åˆ©ç”¨     | è¾ƒçµæ´»            | è¾ƒç²—ç³™             |
  ]

=== è™šæ‹Ÿå­˜å‚¨çš„åŸºæœ¬æ¦‚å¿µ

*è™šæ‹Ÿå­˜å‚¨çš„å®šä¹‰*
- å®šä¹‰
  - è™šæ‹Ÿå­˜å‚¨ = *å†…å­˜ + å¤–å­˜*
- æ€è·¯
  - æ“ä½œç³»ç»Ÿå°†ä¸å¸¸ç”¨çš„éƒ¨åˆ†å†…å­˜æš‚å­˜åˆ°å¤–å­˜ï¼Œå°†è¦å¤„ç†å™¨è®¿é—®çš„æ•°æ®ä»å¤–å­˜è£…å…¥å†…å­˜
- å‰æ
  - ç¨‹åºå…·æœ‰*å±€éƒ¨æ€§*

#figure(
  image("pic/2025-10-23-20-38-01.png", width: 80%),
  numbering: none,
)
ä»å·¦åˆ°å³ä¾æ¬¡æ˜¯ï¼š
#three-line-table[
  | éƒ¨åˆ†                  | å«ä¹‰        | è¯´æ˜                   |
  | ------------------- | --------- | -------------------- |
  | *Virtual Memory*  | è™šæ‹Ÿå†…å­˜      | æ¯ä¸ªè¿›ç¨‹çœ‹åˆ°çš„å®Œæ•´åœ°å€ç©ºé—´ï¼ˆå¦‚4GBï¼‰  |
  | *Memory Map*      | é¡µè¡¨æ˜ å°„è¡¨     | ä¿å­˜è™šæ‹Ÿé¡µå· â†’ ç‰©ç†é¡µå· æˆ– ç£ç›˜ä½ç½® |
  | *Physical Memory* | å®é™…å†…å­˜      | åªä¿å­˜å½“å‰æ´»è·ƒçš„éƒ¨åˆ†é¡µ          |
  | *Disk*            | å¤–å­˜ï¼ˆSwapåŒºï¼‰ | å­˜æ”¾æš‚æœªç”¨åˆ°çš„é¡µ             |
]
å½“è®¿é—®åˆ°ä¸€ä¸ªé¡µï¼š
- è‹¥è¯¥é¡µåœ¨å†…å­˜ï¼Œç›´æ¥è®¿é—®
- è‹¥ä¸åœ¨ï¼Œè§¦å‘ç¼ºé¡µä¸­æ–­ â†’ OS ä»ç£ç›˜ä¸­åŠ è½½ â†’ æ›´æ–°é¡µè¡¨ â†’ é‡æ–°æ‰§è¡ŒæŒ‡ä»¤

*å±€éƒ¨æ€§åŸç†*
- å±€éƒ¨æ€§ï¼ˆlocalityï¼‰ï¼šç¨‹åºåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä¸€ä¸ª*è¾ƒçŸ­æ—¶æœŸ*ï¼Œæ‰€æ‰§è¡Œçš„æŒ‡ä»¤åœ°å€å’ŒæŒ‡ä»¤çš„*æ“ä½œæ•°*åœ°å€ï¼Œåˆ†åˆ«å±€é™äº*ä¸€å®šåŒºåŸŸ*
  - *æ—¶é—´*å±€éƒ¨æ€§ï¼šä¸€æ¡*æŒ‡ä»¤*çš„ä¸€æ¬¡æ‰§è¡Œå’Œä¸‹æ¬¡æ‰§è¡Œï¼Œä¸€ä¸ª*æ•°æ®*çš„ä¸€æ¬¡è®¿é—®å’Œä¸‹æ¬¡è®¿é—®éƒ½é›†ä¸­åœ¨ä¸€ä¸ª*è¾ƒçŸ­æ—¶æœŸ*å†…
  - *ç©ºé—´*å±€éƒ¨æ€§ï¼šå½“å‰æŒ‡ä»¤å’Œé‚»è¿‘æ—¶é—´çš„å‡ æ¡*æŒ‡ä»¤*ï¼Œå½“å‰è®¿é—®çš„*æ•°æ®*å’Œé‚»è¿‘æ—¶é—´è®¿é—®çš„å‡ ä¸ªæ•°æ®éƒ½é›†ä¸­åœ¨ä¸€ä¸ª*è¾ƒå°åŒºåŸŸ*å†…
  - *åˆ†æ”¯*å±€éƒ¨æ€§ï¼šä¸€æ¡*è·³è½¬æŒ‡ä»¤*çš„ä¸¤æ¬¡æ‰§è¡Œï¼Œå¾ˆå¯èƒ½*è·³åˆ°ç›¸åŒçš„å†…å­˜ä½ç½®*
- å±€éƒ¨æ€§çš„æ„ä¹‰ï¼šå¦‚æœå¤§éƒ¨åˆ†ç¨‹åºè¿è¡Œå…·æœ‰å±€éƒ¨æ€§ç‰¹å¾ï¼Œåˆ™è™šæ‹Ÿå­˜å‚¨æŠ€æœ¯æ˜¯èƒ½å¤Ÿå®ç°çš„ï¼Œè€Œä¸”å¯å–å¾—æ»¡æ„çš„æ•ˆæœ

*è™šæ‹Ÿå­˜å‚¨çš„æ€è·¯ä¸è§„åˆ™*
- æ€è·¯ï¼šå°†*ä¸å¸¸ç”¨*çš„éƒ¨åˆ†å†…å­˜å—æš‚å­˜åˆ°å¤–å­˜
- è§„åˆ™ï¼š
  - *è£…è½½*ç¨‹åºæ—¶ï¼šåªå°†*å½“å‰æŒ‡ä»¤æ‰§è¡Œéœ€è¦çš„*éƒ¨åˆ†é¡µé¢æˆ–æ®µè£…å…¥å†…å­˜
  - æŒ‡ä»¤æ‰§è¡Œä¸­éœ€è¦çš„æŒ‡ä»¤æˆ–æ•°æ®*ä¸åœ¨å†…å­˜*ï¼ˆç§°ä¸ºç¼ºé¡µæˆ–ç¼ºæ®µï¼‰æ—¶ï¼šå¤„ç†å™¨é€šçŸ¥æ“ä½œç³»ç»Ÿå°†ç›¸åº”çš„é¡µé¢æˆ–æ®µè°ƒå…¥å†…å­˜
  - æ“ä½œç³»ç»Ÿå°†å†…å­˜ä¸­*æš‚æ—¶ä¸ç”¨*çš„é¡µé¢æˆ–æ®µä¿å­˜åˆ°å¤–å­˜
- å®ç°æ–¹å¼ï¼š
  - è™šæ‹Ÿé¡µå¼å­˜å‚¨
  - è™šæ‹Ÿæ®µå¼å­˜å‚¨
*è™šæ‹Ÿå­˜å‚¨çš„åŸºæœ¬ç‰¹å¾*
- ä¸è¿ç»­æ€§
  - ç‰©ç†å†…å­˜åˆ†é…éè¿ç»­
  - è™šæ‹Ÿåœ°å€ç©ºé—´ä½¿ç”¨éè¿ç»­
- å¤§ç”¨æˆ·ç©ºé—´
  - æä¾›ç»™ç”¨æˆ·çš„è™šæ‹Ÿå†…å­˜å¯å¤§äºå®é™…çš„ç‰©ç†å†…å­˜
- éƒ¨åˆ†äº¤æ¢
  - è™šæ‹Ÿå­˜å‚¨åªå¯¹éƒ¨åˆ†è™šæ‹Ÿåœ°å€ç©ºé—´è¿›è¡Œè°ƒå…¥å’Œè°ƒå‡º

*è™šæ‹Ÿå­˜å‚¨çš„åº•å±‚æ”¯æ’‘*
- ç¡¬ä»¶(MMU/TLB/PageTable)
  - é¡µå¼æˆ–æ®µå¼å­˜å‚¨ä¸­çš„ç¡¬ä»¶åœ°å€è½¬æ¢æœºåˆ¶ã€ç¡¬ä»¶å¼‚å¸¸
- è½¯ä»¶(OS)
  - å†…å­˜ä¸­å»ºç«‹é¡µè¡¨æˆ–æ®µè¡¨
  - ç®¡ç†å†…å­˜å’Œå¤–å­˜é—´é¡µé¢æˆ–æ®µçš„æ¢å…¥å’Œæ¢å‡º

*è™šæ‹Ÿé¡µå¼å­˜å‚¨ç®¡ç†*
- åœ¨é¡µå¼å­˜å‚¨ç®¡ç†çš„åŸºç¡€ä¸Šï¼Œå¢åŠ è¯·æ±‚è°ƒé¡µå’Œé¡µé¢ç½®æ¢
- åŸºæœ¬æ€è·¯
  - å½“ç”¨æˆ·ç¨‹åºè¦è£…è½½åˆ°å†…å­˜æ—¶ï¼Œåªè£…å…¥éƒ¨åˆ†é¡µé¢ï¼Œå°±å¯åŠ¨ç¨‹åºè¿è¡Œ
  - ç”¨æˆ·ç¨‹åºåœ¨è¿è¡Œä¸­å‘ç°æœ‰éœ€è¦çš„ä»£ç æˆ–æ•°æ®ä¸åœ¨å†…å­˜æ—¶ï¼Œåˆ™å‘ç³»ç»Ÿå‘å‡ºç¼ºé¡µå¼‚å¸¸è¯·æ±‚
  - æ“ä½œç³»ç»Ÿåœ¨å¤„ç†ç¼ºé¡µå¼‚å¸¸æ—¶ï¼Œå°†å¤–å­˜ä¸­ç›¸åº”çš„é¡µé¢è°ƒå…¥å†…å­˜ï¼Œä½¿å¾—ç”¨æˆ·ç¨‹åºèƒ½ç»§ç»­è¿è¡Œ
  - å½“å†…å­˜å¿«ç”¨å®Œæ—¶ï¼Œæ“ä½œç³»ç»ŸæŠŠéƒ¨åˆ†é¡µä»å†…å­˜è°ƒå‡ºåˆ°å¤–å­˜
- å…³é”®æœºåˆ¶ï¼š
  - è¯·æ±‚è°ƒé¡µ (Demand Paging)
    - ç¨‹åºè®¿é—®æŸé¡µæ—¶æ‰è£…å…¥å†…å­˜
    - å‡å°‘å¯åŠ¨æ—¶åŠ è½½é‡ï¼Œæé«˜å¹¶å‘
  - é¡µé¢ç½®æ¢ (Page Replacement)
    - å½“å†…å­˜å·²æ»¡æ—¶ï¼Œæ“ä½œç³»ç»Ÿé€‰æ‹©ä¸å¸¸ç”¨é¡µæ¢å‡º
    - å¸¸è§ç®—æ³•ï¼šFIFOã€LRUã€Clock ç­‰
  - ç¼ºé¡µå¼‚å¸¸ (Page Fault)
    - ç¡¬ä»¶æ£€æµ‹åˆ°é¡µä¸å­˜åœ¨
    - é€šçŸ¥æ“ä½œç³»ç»Ÿ
    - å†…æ ¸ä»ç£ç›˜åŠ è½½é¡µ
    - æ¢å¤æ‰§è¡Œ

#figure(
  image("pic/2025-10-23-20-38-44.png", width: 80%),
  numbering: none,
)

ç¼ºé¡µå¼‚å¸¸ï¼ˆPage Faultï¼‰ çš„å®Œæ•´å¤„ç†è·¯å¾„ï¼š
- CPU è®¿é—®è™šæ‹Ÿåœ°å€ (p, o)
- MMU æŸ¥é¡µè¡¨ï¼š
  - è‹¥é¡µè¡¨ä¸­æ ‡å¿—â€œæœ‰æ•ˆä½V=0â€ï¼Œè¯´æ˜è¯¥é¡µä¸åœ¨å†…å­˜
  - è§¦å‘*ç¼ºé¡µå¼‚å¸¸ (Page Fault)*
- OS ç¼ºé¡µå¼‚å¸¸å¤„ç†ï¼š
  - æš‚åœå½“å‰è¿›ç¨‹
  - æŸ¥æ‰¾è¯¥é¡µå¯¹åº”çš„ç£ç›˜ä½ç½®
  - ä»å¤–å­˜è¯»å…¥ä¸€é¡µåˆ°ç‰©ç†å†…å­˜
  - ä¿®æ”¹é¡µè¡¨ï¼šæ›´æ–°ç‰©ç†é¡µå· + è®¾ç½®æœ‰æ•ˆä½
  - æ¢å¤ç¨‹åºè¿è¡Œï¼ˆé‡æ–°æ‰§è¡Œåˆšæ‰é‚£æ¡æŒ‡ä»¤ï¼‰
- å…³é”®ç‚¹ï¼šç¨‹åºå¹¶ä¸çŸ¥é“å‘ç”Ÿäº†ç¼ºé¡µä¸­æ–­ï¼Œå®ƒä¼šâ€œè‡ªåŠ¨æ¢å¤â€

=== ç¼ºé¡µå¼‚å¸¸

*ç¼ºé¡µå¼‚å¸¸çš„å¤„ç†æµç¨‹*
- CPU å°è¯•è®¿é—®å†…å­˜
  - CPU å‘å‡ºè™šæ‹Ÿåœ°å€
  - å…ˆæŸ¥ TLBï¼ˆå¿«è¡¨ï¼‰
    - å‘½ä¸­ â†’ ç›´æ¥è½¬æ¢ä¸ºç‰©ç†åœ°å€
    - æœªå‘½ä¸­ â†’ æŸ¥*é¡µè¡¨*
- é¡µè¡¨é¡¹å­˜åœ¨ä½ V=0
  - é¡µè¡¨ä¸­æ ‡å¿—ä½â€œV=0â€è¯´æ˜è¯¥é¡µå°šæœªè£…å…¥å†…å­˜
  - MMU æ— æ³•æä¾›ç‰©ç†é¡µå·
  - CPU è§¦å‘ä¸€ä¸ªâ€œç¼ºé¡µå¼‚å¸¸â€
  - è¿›å…¥å†…æ ¸æ€ï¼Œç”±æ“ä½œç³»ç»Ÿå¤„ç†
- OS æŸ¥æ‰¾é¡µçš„ä½ç½®
  - æ“ä½œç³»ç»Ÿæ ¹æ®é¡µè¡¨é¡¹æˆ–æ®µæè¿°ç¬¦æ‰¾åˆ°è¯¥é¡µåœ¨å¤–å­˜ä¸­çš„ä½ç½®
  - ä½ç½®ä¿¡æ¯å¯èƒ½åœ¨ï¼š
    - é¡µè¡¨é¡¹ä¸­ï¼ˆå­˜æœ‰ç£ç›˜æ‰‡åŒºå· / swap offsetï¼‰
    - æˆ–è€…åœ¨ç¨‹åºæ˜ å°„çš„æ–‡ä»¶æè¿°ç¬¦ä¸­ï¼ˆå¦‚ ELF æ–‡ä»¶æˆ–å…±äº«åº“ï¼‰
- è°ƒå…¥é¡µï¼ˆä¸¤ç§æƒ…å†µï¼‰
  #three-line-table[
    | æƒ…å†µ              | è¯´æ˜                                                 |
    | --------------- | -------------------------------------------------- |
    | *æœ‰ç©ºé—²ç‰©ç†é¡µå¸§* | ç›´æ¥ä»å¤–å­˜è¯»å–è¯¥é¡µåˆ°ç©ºé—²é¡µå¸§ä¸­                                    |
    | *æ— ç©ºé—²é¡µå¸§*   | å¯åŠ¨*é¡µé¢ç½®æ¢ç®—æ³•*ï¼ˆå¦‚ LRUã€Clockï¼‰ï¼Œé€‰å‡ºä¸€ä¸ªä¸å¸¸ç”¨é¡µæ¢å‡ºåˆ°å¤–å­˜ï¼Œå†è¯»å…¥æ‰€éœ€é¡µ |
  ]
- æ›´æ–°é¡µè¡¨
  - é¡µè¡¨é¡¹é‡æ–°å¡«å†™ï¼š
    - æœ‰æ•ˆä½ V = 1
    - å¡«å…¥æ–°çš„ç‰©ç†é¡µå·
    - è‹¥è¯¥é¡µæ˜¯å¯å†™é¡µï¼Œè¿˜è®¾ç½® D (Dirty)ã€A (Accessed) ç­‰æ ‡å¿—
  - åŒæ—¶æ›´æ–° TLB æˆ–æ¸…ç©ºç›¸å…³ç¼“å­˜é¡¹
- æ¢å¤æ‰§è¡Œ
  - OS è¿”å›æ§åˆ¶æƒç»™ç”¨æˆ·è¿›ç¨‹
  - CPU é‡æ–°æ‰§è¡Œåˆšæ‰å¼•å‘ç¼ºé¡µçš„æŒ‡ä»¤
  - è¿™æ¬¡é¡µè¡¨æœ‰æ•ˆ â†’ æ­£å¸¸è®¿é—®

#figure(
  image("pic/2025-10-23-21-31-10.png", width: 80%),
  numbering: none,
)

*æœªè¢«æ˜ å°„çš„é¡µå­˜æ”¾åœ¨å“ªé‡Œï¼Ÿ*
- äº¤æ¢ç©ºé—´ï¼ˆç£ç›˜/æ–‡ä»¶å½¢æ€ï¼‰
  - é‡‡ç”¨ç‰¹æ®Šæ ¼å¼å­˜å‚¨æœªè¢«æ˜ å°„çš„é¡µé¢
  - ç£ç›˜åˆ†åŒºï¼šä¸€èˆ¬æ˜¯æ‰‡åŒºåœ°å€
  - åœ¨å­˜åœ¨ä½ä¸º0çš„é¡µè¡¨é¡¹ä¸­ä¿å­˜å¤–å­˜çš„é¡µåœ°å€
- ç£ç›˜ä¸Šçš„æ–‡ä»¶(ä»£ç æˆ–æ•°æ®)
  - åœ°å€ç©ºé—´ä¸­çš„é€»è¾‘æ®µè¡¨ç¤ºä¸­æœ‰å¯¹åº”çš„æ–‡ä»¶ä½ç½®
    - å¦‚ï¼š`MemorySet::MapArea`
  - ä»£ç æ®µï¼šå¯æ‰§è¡ŒäºŒè¿›åˆ¶æ–‡ä»¶
  - åŠ¨æ€åŠ è½½çš„å…±äº«åº“ç¨‹åºæ®µï¼šåŠ¨æ€è°ƒç”¨çš„åº“æ–‡ä»¶
  #three-line-table[
    | å­˜æ”¾ä½ç½®                   | è¯´æ˜                          |
    | ---------------------- | --------------------------- |
    | *äº¤æ¢ç©ºé—´ï¼ˆSwap Spaceï¼‰*   | ä¸€å—ç£ç›˜åŒºåŸŸï¼Œç”¨äºå­˜å‚¨è¢«æ¢å‡ºçš„åŒ¿åé¡µï¼ˆå †ã€æ ˆç­‰ï¼‰    |
    | *æ–‡ä»¶æ˜ å°„ï¼ˆFile Mappingï¼‰* | ç¨‹åºä»£ç ã€åŠ¨æ€åº“ã€mmapæ–‡ä»¶é¡µç­‰ï¼Œç›´æ¥ä¸ç£ç›˜æ–‡ä»¶å¯¹åº” |
  ]
- è¿›ä¸€æ­¥ç»†åˆ†
  - åŒ¿åé¡µ (Anonymous Page)
    - æ²¡æœ‰æ–‡ä»¶åå¤‡ï¼Œå¦‚å †ã€æ ˆï¼›æ¢å‡ºæ—¶å­˜åˆ° swap
  - æ–‡ä»¶é¡µ (File-backed Page)
    - æ¥è‡ªå¯æ‰§è¡Œæ–‡ä»¶ã€åŠ¨æ€åº“ï¼›å¯ç›´æ¥ä»æ–‡ä»¶é‡æ–°åŠ è½½

*é¡µè¡¨ä¸­å¦‚ä½•è®°å½•å¤–å­˜é¡µä½ç½®*
- å½“é¡µä¸åœ¨å†…å­˜ä¸­æ—¶ï¼š
  - é¡µè¡¨é¡¹çš„æœ‰æ•ˆä½ V=0
  - å…¶ä½™å­—æ®µï¼ˆPPNï¼‰å¯ä»¥è¢«æ“ä½œç³»ç»Ÿæš‚æ—¶é‡è½½ä¸ºï¼š
    - å¯¹åº”çš„ ç£ç›˜å—å· / æ‰‡åŒºå·
    - æˆ–æŒ‡å‘ä¸€ä¸ª æ–‡ä»¶æ˜ å°„è¡¨ï¼ˆMapAreaï¼‰

*è™šæ‹Ÿå­˜å‚¨çš„æ€§èƒ½*
- æœ‰æ•ˆå­˜å‚¨è®¿é—®æ—¶é—´ï¼ˆEAT, Effective memory Access Timeï¼‰
  - EAT = å†…å­˜è®¿é—®æ—¶é—´$times(1-p)$ + ç¼ºé¡µå¼‚å¸¸å¤„ç†æ—¶é—´
  - ç¼ºé¡µå¼‚å¸¸å¤„ç†æ—¶é—´ = ç£ç›˜è®¿é—®æ—¶é—´$times p(1+q)$
  - $p$: ç¼ºé¡µç‡ï¼›
  - $q$: å†™å›æ¦‚ç‡ï¼ˆæ·˜æ±°ä¸€ä¸ªé¡µé¢åˆ°ç£ç›˜ï¼‰

== å±€éƒ¨é¡µé¢ç½®æ¢ç®—æ³•

#note(subname: [é—®é¢˜])[

  ç”±äºå†…å­˜ç©ºé—´æœ‰é™ï¼Œè€Œæ¯ä¸ªè¿›ç¨‹çš„è™šæ‹Ÿåœ°å€ç©ºé—´å¯èƒ½è¿œå¤§äºç‰©ç†å†…å­˜ã€‚å½“å‘ç”Ÿç¼ºé¡µå¼‚å¸¸ï¼ˆPage Faultï¼‰ä¸”æ²¡æœ‰ç©ºé—²é¡µå¸§æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¿…é¡»é€‰æ‹©ä¸€ä¸ªç°æœ‰é¡µæ¢å‡ºï¼ˆSwap Outï¼‰ï¼ŒæŠŠæ–°çš„é¡µæ¢å…¥ï¼ˆSwap Inï¼‰ã€‚

  é¡µé¢ç½®æ¢ç­–ç•¥åˆ†ç±»
  - #three-line-table[
      | ç±»å‹                           | è¯´æ˜                      | ç‰¹ç‚¹               |
      | ---------------------------- | ----------------------- | ---------------- |
      | *å…¨å±€ç½®æ¢ï¼ˆGlobal Replacementï¼‰* | å„è¿›ç¨‹å…±äº«é¡µå¸§æ± ï¼Œç¼ºé¡µæ—¶å¯ä»ä»»æ„è¿›ç¨‹ä¸­é€‰é¡µæ¢å‡º | å†…å­˜åˆ©ç”¨ç‡é«˜ï¼Œä½†è¿›ç¨‹æ€§èƒ½ä¸å¯é¢„æµ‹ |
      | *å±€éƒ¨ç½®æ¢ï¼ˆLocal Replacementï¼‰*  | æ¯ä¸ªè¿›ç¨‹æœ‰è‡ªå·±å›ºå®šçš„é¡µå¸§é›†åˆï¼Œåªåœ¨å…¶ä¸­é€‰é¡µæ¢å‡º | æ§åˆ¶ç®€å•ã€ç¨³å®šæ€§å¥½        |
    ]
  é¡µé¢ç½®æ¢ç®—æ³•çš„è®¾è®¡æ€è·¯
  - ç½®æ¢æ¡ä»¶ï¼ˆä½•æ—¶ï¼‰
    - å‘ç”Ÿç¼ºé¡µä¸”å†…å­˜å·²æ»¡æ—¶
    - ç³»ç»Ÿå¯èƒ½è¿˜ä¼šæ ¹æ®å†…å­˜å‹åŠ›æå‰è§¦å‘â€œé¢„ç½®æ¢â€
  - é€‰æ‹©æ¡ä»¶ï¼ˆæ¢è°ï¼‰
    - ç›®æ ‡ï¼šæ¢å‡ºâ€œè¿‘æœŸæœ€ä¸å¯èƒ½å†è¢«è®¿é—®â€çš„é¡µ
    - ä¾æ®ï¼šé¡µé¢å†å²è®¿é—®è®°å½•ï¼ˆæˆ–è¿‘ä¼¼å€¼ï¼‰
  ç»å…¸å±€éƒ¨ç½®æ¢ç®—æ³•
  - ä»¥ä¸‹æ˜¯æŒ‰â€œç²¾åº¦ â†’ ä»£ä»·â€é€’å‡æ’åˆ—çš„ä¸»æµç®—æ³•ï¼š
    #three-line-table[
      | ç®—æ³•                | æ€æƒ³           | æ˜¯å¦ç†æƒ³         | å®ç°å¤æ‚åº¦       |
      | ----------------- | ------------ | ------------ | ----------- |
      | *OPT (Optimal)* | æ¢å‡ºæœªæ¥æœ€ä¹…ä¸ç”¨çš„é¡µ   | âœ… ç†è®ºæœ€ä¼˜       | âŒ æœªæ¥ä¸å¯çŸ¥     |
      | *FIFO (å…ˆè¿›å…ˆå‡º)*   | æ¢å‡ºæœ€æ—©è¿›å…¥å†…å­˜çš„é¡µ   | âŒ å®¹æ˜“Beladyå¼‚å¸¸ | âœ… ç®€å•        |
      | *LRU (æœ€è¿‘æœ€å°‘ä½¿ç”¨)*  | æ¢å‡ºæœ€è¿‘æœ€ä¹…æœªä½¿ç”¨çš„é¡µ  | âœ… è¿‘ä¼¼OPT      | âš™ï¸ éœ€ç¡¬ä»¶æ”¯æŒ    |
      | *Clock (æ—¶é’Ÿ)*    | LRUçš„é«˜æ•ˆè¿‘ä¼¼ç®—æ³•   | âœ… å®ç”¨æŠ˜ä¸­       | âœ… å¸¸ç”¨        |
      | *LFU (æœ€å°‘ä½¿ç”¨æ¬¡æ•°)*  | æ¢å‡ºä½¿ç”¨é¢‘ç‡æœ€ä½çš„é¡µ   | âš™ï¸ æ…¢å“åº”çŸ­æœŸå˜åŒ–   | âš™ï¸ ç¨€ç”¨       |
      | *NRU (æœªä½¿ç”¨é¡µé¢)*   | æ ¹æ®æœ€è¿‘è®¿é—®ä½è¿‘ä¼¼LRU | âœ… å¿«é€Ÿå®ç°       | âœ… Linuxå¸¸ç”¨å˜ç§ |
    ]
  åœ¨è¿›ç¨‹æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œå¦‚ä½•ç¡®å®è¿›ç¨‹åœ°å€ç©ºé—´ä¸­å“ªäº›æ”¾åˆ°å¤–å­˜ï¼Ÿ
  - ç”±ç½®æ¢ç®—æ³•å†³å®šï¼Œä¼˜å…ˆæ¢å‡ºè¿‘æœŸ/é•¿æœŸä¸å†ä½¿ç”¨çš„é¡µ
  é€‰æ‹©ç½®æ¢é¡µé¢æ¡ä»¶æ˜¯ä»€ä¹ˆï¼Ÿ
  - ç¼ºé¡µå¼‚å¸¸ä¸”æ— ç©ºé—²é¡µå¸§
  åœ¨ä»€ä¹ˆèŒƒå›´å†…è¿›è¡Œé¡µé¢ç½®æ¢ï¼Ÿ
  - å±€éƒ¨ç½®æ¢ â†’ å½“å‰è¿›ç¨‹é¡µå¸§å†…ï¼›å…¨å±€ç½®æ¢ â†’ æ‰€æœ‰è¿›ç¨‹é¡µå¸§æ± 
  ç½®æ¢æ¡ä»¶çš„è®¡ç®—ç²¾åº¦å’Œå¼€é”€å¦‚ä½•å–èˆï¼Ÿ
  - ç²¾åº¦é«˜ â†’ ä»£ä»·å¤§ï¼ˆLRUï¼‰ï¼ŒæŠ˜ä¸­ç®—æ³•ï¼ˆClockï¼‰æœ€å¸¸ç”¨
]

=== é¡µé¢ç½®æ¢ç®—æ³•çš„åŸºæœ¬æ¦‚å¿µ

*é¡µé¢ç½®æ¢ç®—æ³•çš„åŠŸèƒ½ä¸è®¾è®¡ç›®æ ‡*
- åŠŸèƒ½
  - å‡ºç°ç¼ºé¡µå¼‚å¸¸éœ€è°ƒå…¥æ–°é¡µé¢è€Œå†…å­˜å·²æ»¡æ—¶ï¼Œç½®æ¢ç®—æ³•é€‰æ‹©è¢«ç½®æ¢çš„ç‰©ç†é¡µé¢
- è®¾è®¡ç›®æ ‡
  - å°½å¯èƒ½å‡å°‘é¡µé¢*ç¼ºé¡µæ¬¡æ•°ã€æ¢å…¥/æ¢å‡ºæ¬¡æ•°*
  - æŠŠæœªæ¥*ä¸å†è®¿é—®*æˆ–*çŸ­æœŸå†…ä¸è®¿é—®*çš„é¡µé¢è°ƒå‡º
*é¡µé¢ç½®æ¢çš„æ—¶æœº*
- *ç©ºé—²å†…å­˜*æ•°é‡ä¸Šé™å’Œä¸‹é™
- åˆ°è¾¾ä¸‹é™ï¼Œå¼€å§‹å›æ”¶å†…å­˜
- åˆ°è¾¾ä¸Šé™ï¼Œæš‚åœå›æ”¶å†…å­˜
  #figure(
    image("pic/2025-10-24-16-30-31.png", width: 80%),
    numbering: none,
  )
*é¡µé¢ç½®æ¢å¤„ç†æµç¨‹*
- ç¼ºé¡µå¼‚å¸¸å¤„ç† + é¡µé¢ç½®æ¢è¿‡ç¨‹
  #three-line-table[
    | æ­¥éª¤           | è¿‡ç¨‹è¯´æ˜                                     |
    | :--- | --- |
    | *â‘  load M* | CPUè®¿é—®è™šæ‹Ÿåœ°å€ Mï¼Œé¡µè¡¨é¡¹æ— æ•ˆï¼ˆV=0ï¼‰                   |
    | *â‘¡ å¼‚å¸¸*     | MMUè§¦å‘ç¼ºé¡µå¼‚å¸¸ï¼ŒCPUé™·å…¥æ“ä½œç³»ç»Ÿ                      |
    | *â‘¢ æŸ¥æ‰¾å¤–å­˜é¡µé¢* | OSæŸ¥é¡µè¡¨/æ®µè¡¨æˆ–æ–‡ä»¶æ˜ å°„ä¿¡æ¯ï¼Œç¡®å®šè¯¥é¡µåœ¨å¤–å­˜ä½ç½®                |
    | *â‘£ é¡µé¢æ¢å…¥*   | è‹¥æœ‰ç©ºé—²é¡µå¸§ï¼Œç›´æ¥ä»ç£ç›˜å°†é¡µé¢è¯»å…¥ï¼›å¦åˆ™ï¼Œæ‰§è¡Œç½®æ¢ç®—æ³•é€‰å‡ºç‰ºç‰²é¡µï¼ˆå¯èƒ½éœ€è¦å†™å›ï¼‰ |
    | *â‘¤ é¡µè¡¨é¡¹ä¿®æ”¹*  | æ›´æ–°é¡µè¡¨é¡¹ï¼šè®¾ç½®æ–°çš„ç‰©ç†é¡µå·ã€æœ‰æ•ˆä½V=1ã€æ¸…ç©ºè„ä½D=0 ç­‰          |
    | *â‘¥ æŒ‡ä»¤é‡æ‰§è¡Œ*  | è¿”å›ç”¨æˆ·æ€ï¼Œé‡æ–°æ‰§è¡Œè§¦å‘ç¼ºé¡µçš„é‚£æ¡æŒ‡ä»¤                      |
  ]

*é¡µé¢é”å®š(frame locking)/å¸¸é©»å†…å­˜*
- *å¿…é¡»å¸¸é©»å†…å­˜*çš„é€»è¾‘é¡µé¢
  - æ“ä½œç³»ç»Ÿçš„å…³é”®éƒ¨åˆ†ï¼ˆä¾‹å¦‚é¡µè¡¨æœ¬èº«ã€è°ƒé¡µä¸­æ–­å¤„ç†ä»£ç ï¼‰
  - è¦æ±‚å“åº”é€Ÿåº¦çš„ä»£ç å’Œæ•°æ®
  - å…³é”®å†…æ ¸æ•°æ®ç»“æ„ï¼ˆä¾‹å¦‚ I/O ç¼“å†²åŒºï¼‰ã€‚
- è¿™ç±»é¡µé¢åœ¨é¡µè¡¨é¡¹ä¸­ä¼šè®¾ç½® é”å®šä½ï¼ˆLock Bitï¼‰ï¼š
  - è¡¨ç¤ºè¯¥é¡µä¸å¯è¢«ç½®æ¢ï¼ˆpinned / lockedï¼‰

*é¡µé¢ç½®æ¢ç®—æ³•çš„è¯„ä»·æ–¹æ³•*
- è¯„ä»·æ–¹æ³•
  - è®°å½•è¿›ç¨‹è®¿é—®å†…å­˜é¡µé¢çš„è½¨è¿¹ï¼Œæ¨¡æ‹Ÿç½®æ¢è¡Œä¸ºï¼Œè®°å½•*ç¼ºé¡µæ¬¡æ•°*
  - *æ›´å°‘çš„ç¼ºé¡µï¼Œæ›´å¥½çš„æ€§èƒ½*
- ç¤ºä¾‹: è™šæ‹Ÿåœ°å€è®¿é—®ç”¨(é¡µå·, ä½ç§»)è¡¨ç¤º
  ```
  (3,0),  (1,9),  (4,1),  (2,1),  (5,3),  (2,0),  (1,9),  (2,4),  (3,1),  (4,8)
  ```
  å¯¹åº”çš„é¡µé¢è½¨è¿¹
  ```
  3, 1, 4, 2, 5, 2, 1, 2, 3, 4 ç”¨æ•°å­—è¡¨ç¤º
  c, a, d, b, e, b, a, b, c, d ç”¨å­—ç¬¦è¡¨ç¤º
  ```
*é¡µé¢ç½®æ¢ç®—æ³•çš„åˆ†ç±»*
- *å±€éƒ¨*é¡µé¢ç½®æ¢ç®—æ³•
  - ç½®æ¢é¡µé¢çš„é€‰æ‹©èŒƒå›´ä»…é™äº*å½“å‰è¿›ç¨‹*å ç”¨çš„ç‰©ç†é¡µé¢å†…
  - æœ€ä¼˜ç®—æ³•ã€å…ˆè¿›å…ˆå‡ºç®—æ³•ã€æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨ç®—æ³•
  - æ—¶é’Ÿç®—æ³•ã€æœ€ä¸å¸¸ç”¨ç®—æ³•
- *å…¨å±€*é¡µé¢ç½®æ¢ç®—æ³•
  - ç½®æ¢é¡µé¢çš„é€‰æ‹©èŒƒå›´æ˜¯*æ‰€æœ‰*å¯æ¢å‡ºçš„ç‰©ç†é¡µé¢
  - å·¥ä½œé›†ç®—æ³•ã€ç¼ºé¡µç‡ç®—æ³•
  #three-line-table[
    | åˆ†ç±»         | èŒƒå›´               | ä»£è¡¨ç®—æ³•                       | ç‰¹ç‚¹               |
    | ---------- | ---------------- | -------------------------- | ---------------- |
    | *å±€éƒ¨é¡µé¢ç½®æ¢* | ä»…åœ¨å½“å‰è¿›ç¨‹çš„é¡µå¸§ä¸­é€‰æ‹©ç‰ºç‰²é¡µ  | OPT, FIFO, LRU, Clock, LFU | ç¨³å®šã€ç‹¬ç«‹æ€§å¼º          |
    | *å…¨å±€é¡µé¢ç½®æ¢* | å¯åœ¨æ‰€æœ‰è¿›ç¨‹çš„é¡µå¸§æ± ä¸­é€‰æ‹©ç‰ºç‰²é¡µ | å·¥ä½œé›†ç®—æ³•ã€ç¼ºé¡µç‡ç®—æ³•                | æé«˜æ•´ä½“åˆ©ç”¨ç‡ï¼Œä½†è¿›ç¨‹æ€§èƒ½æ³¢åŠ¨å¤§ |
  ]

=== æœ€ä¼˜é¡µé¢ç½®æ¢ç®—æ³• (OPT, optimal)

*æœ€ä¼˜é¡µé¢ç½®æ¢ç®—æ³•çš„å·¥ä½œåŸç†*
- åŸºæœ¬æ€è·¯
  - ç½®æ¢åœ¨*æœªæ¥æœ€é•¿æ—¶é—´ä¸è®¿é—®*çš„é¡µé¢
- ç®—æ³•å®ç°
  - ç¼ºé¡µæ—¶ï¼Œè®¡ç®—å†…å­˜ä¸­æ¯ä¸ªé€»è¾‘é¡µé¢çš„*ä¸‹ä¸€æ¬¡è®¿é—®æ—¶é—´*
  - é€‰æ‹©æœªæ¥æœ€é•¿æ—¶é—´ä¸è®¿é—®çš„é¡µé¢
*æœ€ä¼˜é¡µé¢ç½®æ¢ç®—æ³•ç‰¹å¾*
- ç¼ºé¡µæœ€å°‘ï¼Œæ˜¯*ç†æƒ³æƒ…å†µ*
- å®é™…ç³»ç»Ÿä¸­*æ— æ³•å®ç°*
- *æ— æ³•é¢„çŸ¥*æ¯ä¸ªé¡µé¢åœ¨ä¸‹æ¬¡è®¿é—®å‰çš„ç­‰å¾…æ—¶é—´
  - åœ¨æ¨¡æ‹Ÿå™¨ä¸Šè¿è¡ŒæŸä¸ªç¨‹åºï¼Œå¹¶è®°å½•æ¯ä¸€æ¬¡çš„é¡µé¢è®¿é—®æƒ…å†µ
  - ç¬¬äºŒéè¿è¡Œæ—¶ä½¿ç”¨æœ€ä¼˜ç®—æ³•
*æœ€ä¼˜é¡µé¢ç½®æ¢ç®—æ³•ç¤ºä¾‹*
#figure(
  image("pic/2025-10-24-16-43-39.png", width: 80%),
  numbering: none,
)
#three-line-table[
  | ç‰¹å¾        | è¯´æ˜                           |
  | --------- | ---------------------------- |
  | *ç†è®ºæœ€ä¼˜*  | ç¼ºé¡µç‡æœ€ä½ï¼Œæ˜¯æ‰€æœ‰ç®—æ³•çš„æ€§èƒ½ä¸Šç•Œ             |
  | *ä¸å¯å®ç°*  | éœ€è¦é¢„çŸ¥â€œæœªæ¥è®¿é—®åºåˆ—â€ï¼Œå®é™…ç³»ç»Ÿæ— æ³•åšåˆ°        |
  | *ç ”ç©¶æ„ä¹‰*  | å¸¸ä½œä¸ºå…¶ä»–ç®—æ³•ï¼ˆFIFOã€LRUã€Clockï¼‰çš„å¯¹æ¯”åŸºå‡† |
  | *ä»¿çœŸå¯å®ç°* | åœ¨å®éªŒæˆ–æ¨¡æ‹Ÿä¸­å¯å®ç°ï¼Œé€šè¿‡â€œç¬¬äºŒéè¿è¡Œè®°å½•â€è®¿é—®åºåˆ—   |
]

=== å…ˆè¿›å…ˆå‡ºé¡µé¢ç½®æ¢ç®—æ³• (FIFO)

*å…ˆè¿›å…ˆå‡ºç®—æ³•çš„å·¥ä½œåŸç†*
- åŸºæœ¬æ€è·¯
  - é€‰æ‹©åœ¨å†…å­˜*é©»ç•™æ—¶é—´æœ€é•¿*çš„é¡µé¢è¿›è¡Œç½®æ¢
- ç®—æ³•å®ç°
  - ç»´æŠ¤ä¸€ä¸ªè®°å½•æ‰€æœ‰*ä½äºå†…å­˜ä¸­çš„é€»è¾‘é¡µé¢é“¾è¡¨*
  - é“¾è¡¨å…ƒç´ *æŒ‰é©»ç•™å†…å­˜çš„æ—¶é—´æ’åº*ï¼Œé“¾é¦–æœ€é•¿ï¼Œé“¾å°¾æœ€çŸ­
  - å‡ºç°ç¼ºé¡µæ—¶ï¼Œ*é€‰æ‹©*é“¾é¦–é¡µé¢è¿›è¡Œç½®æ¢ï¼Œæ–°é¡µé¢åŠ åˆ°é“¾å°¾
  - ç”±æ­¤å½¢æˆä¸€ä¸ªâ€œé¡µé¢ç”Ÿå‘½å‘¨æœŸç®¡ç†é“¾â€
*å…ˆè¿›å…ˆå‡ºç®—æ³•ç‰¹å¾*
- å®ç°ç®€å•
- æ€§èƒ½è¾ƒå·®ï¼Œè°ƒå‡ºçš„é¡µé¢å¯èƒ½æ˜¯ç»å¸¸è®¿é—®çš„
- åˆ†é…ç‰©ç†é¡µé¢æ•°å¢åŠ æ—¶ï¼Œç¼ºé¡µå¹¶ä¸ä¸€å®šå‡å°‘(Beladyç°è±¡)
- å¾ˆå°‘å•ç‹¬ä½¿ç”¨
*å…ˆè¿›å…ˆå‡ºç®—æ³•ç¤ºä¾‹*
#figure(
  image("pic/2025-10-24-16-55-02.png", width: 80%),
  numbering: none,
)
#three-line-table[
  | ä¼˜ç‚¹               | ç¼ºç‚¹                             |
  | ---------------- | ------------------------------ |
  | âœ… å®ç°ç®€å•ï¼Œæ˜“äºç¡¬ä»¶/è½¯ä»¶æ”¯æŒ | âŒ æ€§èƒ½è¾ƒå·®ï¼Œå¯èƒ½æ¢å‡ºâ€œçƒ­é—¨é¡µâ€               |
  | âœ… é€»è¾‘æ¸…æ™°ï¼ˆå…ˆè¿›å…ˆå‡ºï¼‰     | âŒ ç¼ºé¡µç‡å¯èƒ½ä¸éšå†…å­˜å¢åŠ è€Œä¸‹é™ï¼ˆ*Beladyå¼‚å¸¸*ï¼‰ |
]
*Belady å¼‚å¸¸ï¼ˆBeladyâ€™s Anomalyï¼‰*
- å¢åŠ ç‰©ç†é¡µå¸§æ•°åï¼Œç¼ºé¡µæ¬¡æ•°åè€Œå¯èƒ½ä¸Šå‡
- ä¾‹å¦‚ï¼šè®¿é—®åºåˆ— `1, 2, 3, 4, 1, 2, 5, 1, 2, 3, 4, 5`
  - 3 ä¸ªé¡µå¸§æ—¶ç¼ºé¡µ 9 æ¬¡
  - 4 ä¸ªé¡µå¸§æ—¶ç¼ºé¡µåè€Œå˜æˆ 10 æ¬¡
- äº§ç”ŸåŸå› ï¼š
  - FIFO åªè€ƒè™‘â€œè¿›å…¥é¡ºåºâ€ï¼Œä¸è€ƒè™‘â€œè®¿é—®é¢‘ç‡â€æˆ–â€œå±€éƒ¨æ€§â€
  - å› æ­¤å¯èƒ½é”™è¯¯åœ°æ·˜æ±°äº†ä»åœ¨å·¥ä½œé›†ä¸­çš„é¡µ

=== æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨é¡µé¢ç½®æ¢ç®—æ³• (LRU, Least Recently Used)

*æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨ç®—æ³•çš„å·¥ä½œåŸç†*
- åŸºæœ¬æ€è·¯
  - é€‰æ‹©*æœ€é•¿æ—¶é—´æ²¡æœ‰è¢«å¼•ç”¨*çš„é¡µé¢è¿›è¡Œç½®æ¢
  - å¦‚æŸé¡µé¢é•¿æ—¶é—´æœªè¢«è®¿é—®ï¼Œåˆ™å®ƒ*åœ¨å°†æ¥è¿˜å¯èƒ½*ä¼šé•¿æ—¶é—´ä¸ä¼šè®¿é—®
- ç®—æ³•å®ç°
  - ç¼ºé¡µæ—¶ï¼Œè®¡ç®—å†…å­˜ä¸­æ¯ä¸ªé€»è¾‘é¡µé¢çš„*ä¸Šä¸€æ¬¡è®¿é—®*æ—¶é—´
  - é€‰æ‹©ä¸Šä¸€æ¬¡ä½¿ç”¨åˆ°å½“å‰æ—¶é—´æœ€é•¿çš„é¡µé¢è¿›è¡Œç½®æ¢
- ç®—æ³•ç‰¹å¾
  - *æœ€ä¼˜ç½®æ¢ç®—æ³•çš„ä¸€ç§è¿‘ä¼¼*

*æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨ç®—æ³•ç¤ºä¾‹*
#figure(
  image("pic/2025-10-24-17-01-50.png", width: 80%),
  numbering: none,
)

*ä¸¤ç§å…¸å‹å®ç°æ–¹å¼*
- LRUçš„é¡µé¢é“¾è¡¨å®ç°
  - é¡µé¢é“¾è¡¨
    - ç³»ç»Ÿç»´æŠ¤ä¸€ä¸ª*æŒ‰æœ€è¿‘ä¸€æ¬¡è®¿é—®æ—¶é—´æ’åºçš„é¡µé¢é“¾è¡¨*
      - *é“¾è¡¨é¦–èŠ‚ç‚¹*æ˜¯æœ€è¿‘åˆšåˆšä½¿ç”¨è¿‡çš„é¡µé¢
      - *é“¾è¡¨å°¾èŠ‚ç‚¹*æ˜¯æœ€ä¹…æœªä½¿ç”¨çš„é¡µé¢
    - è®¿é—®å†…å­˜æ—¶ï¼Œæ‰¾åˆ°ç›¸åº”é¡µé¢ï¼Œå¹¶æŠŠå®ƒç§»åˆ°é“¾è¡¨ä¹‹é¦–
    - ç¼ºé¡µæ—¶ï¼Œç½®æ¢é“¾è¡¨å°¾èŠ‚ç‚¹çš„é¡µé¢
  - ç‰¹å¾
    - é“¾è¡¨æ“ä½œï¼ˆç§»åŠ¨èŠ‚ç‚¹ï¼‰æˆæœ¬è¾ƒé«˜ã€‚
- LRUçš„æ´»åŠ¨é¡µé¢æ ˆå®ç°
  - æ´»åŠ¨é¡µé¢æ ˆ
    - è®¿é—®é¡µé¢æ—¶ï¼Œå°†æ­¤*é¡µå·å‹å…¥æ ˆé¡¶*ï¼Œå¹¶æ ˆå†…ç›¸åŒçš„é¡µå·æŠ½å‡º
    - ç¼ºé¡µæ—¶ï¼Œ*ç½®æ¢æ ˆåº•*çš„é¡µé¢
  - ç‰¹å¾
    - æ›´æ–°æ—¶æ ˆè°ƒæ•´å¼€é”€è¾ƒå¤§
#three-line-table[
  | ç®—æ³•       | æ€æƒ³        | æ˜¯å¦é¢„çŸ¥æœªæ¥ | å®ç°å¤æ‚åº¦  | ç¼ºé¡µç‡         | æ˜¯å¦å‡ºç° Belady å¼‚å¸¸ |
  | -------- | --------- | ------ | ------ | ----------- | -------------- |
  | *OPT*  | ç½®æ¢æœªæ¥æœ€ä¹…ä¸è®¿é—® | âœ… æ˜¯    | âŒ ä¸å¯å®ç° | â­ æœ€ä½        | âŒ ä¸ä¼š           |
  | *FIFO* | ç½®æ¢æœ€æ—©è¿›å…¥çš„é¡µ  | âŒ å¦    | âœ… ç®€å•   | âŒ è¾ƒé«˜        | âœ… å¯èƒ½           |
  | *LRU*  | ç½®æ¢æœ€è¿‘æœ€ä¹…æœªç”¨  | âŒ å¦    | âš™ï¸ ä¸­ç­‰  | â­ è¾ƒä½ï¼ˆè¿‘ä¼¼OPTï¼‰ | âŒ ä¸ä¼š           |
]
#newpara()
*LRUçš„æ´»åŠ¨é¡µé¢æ ˆå®ç°ç¤ºä¾‹*
#figure(
  image("pic/2025-10-24-17-19-56.png", width: 80%),
  numbering: none,
)

=== æ—¶é’Ÿé¡µé¢ç½®æ¢ç®—æ³• (Clock)

*æ—¶é’Ÿç½®æ¢ç®—æ³•çš„å·¥ä½œåŸç†*
- åŸºæœ¬æ€è·¯
  - ä»…å¯¹é¡µé¢çš„è®¿é—®æƒ…å†µè¿›è¡Œ*å¤§è‡´ç»Ÿè®¡*
- æ•°æ®ç»“æ„
  - åœ¨é¡µè¡¨é¡¹ä¸­å¢åŠ *è®¿é—®ä½*ï¼Œæè¿°é¡µé¢åœ¨è¿‡å»ä¸€æ®µæ—¶é—´çš„å†…è®¿é—®æƒ…å†µ
  - å„é¡µé¢ç»„ç»‡æˆ*ç¯å½¢é“¾è¡¨*
  - æŒ‡é’ˆæŒ‡å‘*æœ€å…ˆè°ƒå…¥çš„é¡µé¢*
  - åœ¨é¡µè¡¨é¡¹ï¼ˆPage Table Entryï¼‰ä¸­å¢åŠ ä¸¤ä¸ªæ ‡å¿—ä½ï¼š
    #three-line-table[
      | å­—æ®µ                  | è¯´æ˜                        |
      | ------------------- | ------------------------- |
      | *é©»ç•™ä½ (R)*         | è¡¨ç¤ºé¡µé¢æ˜¯å¦åœ¨å†…å­˜ä¸­ï¼ˆ1=åœ¨ï¼Œ0=ä¸åœ¨ï¼‰      |
      | *è®¿é—®ä½ (A)*         | è¡¨ç¤ºè¯¥é¡µæœ€è¿‘æ˜¯å¦è¢«è®¿é—®è¿‡ï¼ˆ1=è®¿é—®è¿‡ï¼Œ0=æœªè®¿é—®ï¼‰ |
      | *é¡µå¸§å· (Frame No.)* | æ˜ å°„çš„ç‰©ç†é¡µå·                   |
    ]
- ç®—æ³•å®ç°
  - *è®¿é—®é¡µé¢æ—¶*ï¼Œåœ¨é¡µè¡¨é¡¹è®°å½•é¡µé¢è®¿é—®æƒ…å†µ
  - *ç¼ºé¡µæ—¶*ï¼Œä»æŒ‡é’ˆå¤„å¼€å§‹é¡ºåºæŸ¥æ‰¾æœªè¢«è®¿é—®çš„é¡µé¢è¿›è¡Œç½®æ¢
#figure(
  image("pic/2025-10-24-17-22-23.png", width: 40%),
  numbering: none,
)

*æ—¶é’Ÿç½®æ¢ç®—æ³•çš„å…·ä½“å®ç°è¿‡ç¨‹*
- é¡µé¢*è£…å…¥å†…å­˜æ—¶*ï¼Œè®¿é—®ä½åˆå§‹åŒ–ä¸º0
- *è®¿é—®é¡µé¢ï¼ˆè¯»/å†™)æ—¶*ï¼Œè®¿é—®ä½ç½®1
- *ç¼ºé¡µæ—¶*ï¼Œä»æŒ‡é’ˆå½“å‰ä½ç½®é¡ºåºæ£€æŸ¥
  - è®¿é—®ä½ä¸º0ï¼Œåˆ™ç½®æ¢è¯¥é¡µ
  - è®¿é—®ä½ä¸º1ï¼Œåˆ™è®¿é—®ä½ç½®0ï¼Œå¹¶æŒ‡é’ˆç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªé¡µé¢ï¼Œç›´åˆ°æ‰¾åˆ°å¯ç½®æ¢çš„é¡µé¢
- ç®—æ³•ç‰¹å¾
  - æ—¶é’Ÿç®—æ³•æ˜¯LRUå’ŒFIFOçš„æŠ˜ä¸­

*æ—¶é’Ÿç½®æ¢ç®—æ³•ç¤ºä¾‹*
#figure(
  image("pic/2025-10-24-22-44-27.png", width: 80%),
  numbering: none,
)

#three-line-table[
  | ç‰¹å¾          | è¯´æ˜                                |
  | ----------- | --------------------------------- |
  | *æ€æƒ³æ¥æº*  | LRU çš„è¿‘ä¼¼å®ç°                         |
  | *ç¡¬ä»¶æ”¯æŒ* | ä¾èµ–é¡µè¡¨é¡¹çš„è®¿é—®ä½ï¼ˆAä½ï¼‰                     |
  | *ä¼˜ç‚¹*   | å®ç°ç®€å•ï¼Œæ€§èƒ½æ¥è¿‘ LRUï¼Œç³»ç»Ÿå¼€é”€å°               |
  | *ç¼ºç‚¹*   | æ— æ³•ç²¾ç¡®åæ˜ è®¿é—®çš„æ—¶é—´é¡ºåºï¼Œä»…è¿‘ä¼¼â€œæœ€è¿‘æœ€å°‘ä½¿ç”¨â€         |
  | *æ•ˆæœ*   | ç¼ºé¡µç‡ä½äº FIFOï¼Œç•¥é«˜äº LRUï¼›ä¸ä¼šå‡ºç° Belady å¼‚å¸¸ |
]

#three-line-table[
  | ç®—æ³•        | æ€æƒ³           | å¼€é”€ | ç¼ºé¡µç‡      | æ˜¯å¦å‡ºç° Belady å¼‚å¸¸ |
  | --------- | ------------ | -- | -------- | -------------- |
  | *FIFO*  | æŒ‰è¿›å…¥é¡ºåºæ·˜æ±°      | ä½  | é«˜        | âœ… ä¼š            |
  | *LRU*   | æ·˜æ±°æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨é¡µ   | é«˜  | ä½        | âŒ ä¸ä¼š           |
  | *Clock* | ç»™è¢«è®¿é—®é¡µâ€œç¬¬äºŒæ¬¡æœºä¼šâ€ | ä¸­  | ä½ï¼ˆæ¥è¿‘LRUï¼‰ | âŒ ä¸ä¼š           |
]

=== æ”¹è¿›çš„æ—¶é’Ÿé¡µé¢ç½®æ¢ç®—æ³•

*æ”¹è¿›çš„æ—¶é’Ÿç½®æ¢ç®—æ³•çš„å·¥ä½œåŸç†*
- åŸºæœ¬æ€è·¯
  - å‡å°‘*ä¿®æ”¹é¡µ*çš„ç¼ºé¡µå¤„ç†å¼€é”€
  - åœ¨ç½®æ¢é¡µé¢æ—¶ï¼Œä¼˜å…ˆé€‰æ‹©â€œæœ€è¿‘æ²¡è¢«è®¿é—®ä¸”æ²¡è¢«ä¿®æ”¹â€çš„é¡µé¢ï¼Œä»è€Œå‡å°‘å†™å›ç£ç›˜çš„å¼€é”€
- æ•°æ®ç»“æ„
  - åœ¨é¡µé¢ä¸­å¢åŠ *ä¿®æ”¹ä½*ï¼Œæè¿°é¡µé¢åœ¨è¿‡å»ä¸€æ®µæ—¶é—´çš„å†…å†™è®¿é—®æƒ…å†µ
  - æ¯ä¸ªé¡µè¡¨é¡¹åŒ…å«ä¸‰ä¸ªå…³é”®æ ‡å¿—ä½ï¼š
    #three-line-table[
      | å­—æ®µ          | å«ä¹‰                         |
      | ----------- | -------------------------- |
      | *é©»ç•™ä½ (R)* | æ˜¯å¦åœ¨å†…å­˜ä¸­ï¼ˆ1=åœ¨ï¼Œ0=ä¸åœ¨ï¼‰           |
      | *è®¿é—®ä½ (A)* | æ˜¯å¦åœ¨æœ€è¿‘ä¸€æ®µæ—¶é—´è¢«è®¿é—®è¿‡ï¼ˆ1=è®¿é—®è¿‡ï¼Œ0=æœªè®¿é—®ï¼‰ |
      | *ä¿®æ”¹ä½ (M)* | æ˜¯å¦è¢«ä¿®æ”¹è¿‡ï¼ˆ1=è¢«å†™è¿‡ï¼Œ0=æœªä¿®æ”¹ï¼‰        |
    ]
- ç®—æ³•å®ç°
  - è®¿é—®é¡µé¢æ—¶ï¼Œåœ¨é¡µè¡¨é¡¹è®°å½•é¡µé¢è®¿é—®æƒ…å†µ
  - *ä¿®æ”¹é¡µé¢æ—¶*ï¼Œåœ¨é¡µè¡¨é¡¹è®°å½•é¡µé¢ä¿®æ”¹æƒ…å†µ
  - ç¼ºé¡µæ—¶ï¼Œä¿®æ”¹é¡µé¢æ ‡å¿—ä½ï¼Œä»¥*è·³è¿‡*æœ‰ä¿®æ”¹çš„é¡µé¢

#figure(
  image("pic/2025-10-24-22-57-30.png", width: 80%),
  numbering: none,
)

*é¡µé¢é€‰æ‹©ç­–ç•¥ï¼ˆå››ç§ç±»åˆ«ï¼‰*
- åœ¨ç¼ºé¡µæ—¶ï¼Œç®—æ³•ä¼šå¤šæ¬¡æ‰«æç¯ï¼ŒæŒ‰ä»¥ä¸‹ä¼˜å…ˆçº§æŸ¥æ‰¾å¯æ›¿æ¢é¡µé¢ï¼š
  #three-line-table[
    | æ‰«æé¡ºåº | ä½¿ç”¨ä½ (A) | ä¿®æ”¹ä½ (M) | å«ä¹‰                        | ä¼˜å…ˆçº§     |
    | ---- | ------- | ------- | ------------------------- | ------- |
    | â‘     | 0       | 0       | æœªè¢«è®¿é—® & æœªè¢«ä¿®æ”¹ â†’ âœ… *æœ€ä½³æ¢å‡ºé¡µ* | ğŸ¥‡ ç¬¬ä¸€ä¼˜å…ˆ |
    | â‘¡    | 0       | 1       | æœªè¢«è®¿é—® & è¢«ä¿®æ”¹è¿‡ â†’ ğŸ“¦ éœ€å†™å›ç£ç›˜    | ğŸ¥ˆ ç¬¬äºŒä¼˜å…ˆ |
    | â‘¢    | 1       | 0       | è¢«è®¿é—®è¿‡ & æœªä¿®æ”¹ â†’ æ¸…é™¤è®¿é—®ä½ï¼Œä¸‹æ¬¡å†è€ƒè™‘  | ğŸ¥‰ ç¬¬ä¸‰ä¼˜å…ˆ |
    | â‘£    | 1       | 1       | è¢«è®¿é—®è¿‡ & è¢«ä¿®æ”¹ â†’ æ¸…é™¤è®¿é—®ä½ï¼Œä¸‹æ¬¡å†è€ƒè™‘  | ğŸª¶ æœ€ä½ä¼˜å…ˆ |
  ]
  å¦‚æœåœ¨ç¬¬ä¸€è½®æ²¡æ‰¾åˆ° (0,0)ï¼Œåˆ™ä¼šæ¸…é›¶è®¿é—®ä½ï¼Œå†é‡æ–°æ‰«æã€‚

*æ”¹è¿›çš„æ—¶é’Ÿç½®æ¢ç®—æ³•ç¤ºä¾‹*

#figure(
  image("pic/2025-10-24-22-59-21.png", width: 80%),
  numbering: none,
)

#three-line-table[
  | ç‰¹å¾          | è¯´æ˜                             |
  | ----------- | ------------------------------ |
  | *ä¼˜ç‚¹*    | å‡å°‘ç£ç›˜å†™å›æ¬¡æ•°ï¼Œæé«˜æ•´ä½“æ€§èƒ½                |
  | *åŸç†*   | ä¼˜å…ˆæ·˜æ±°æœªè¢«è®¿é—®ä¸”æœªä¿®æ”¹çš„é¡µ                 |
  | *å®ç°*   | ä½¿ç”¨ (A, M) ä¸¤ä½ç»„åˆåŒºåˆ†é¡µé¢çŠ¶æ€           |
  | *è½®è¯¢æœºåˆ¶* | å¤šæ¬¡æ‰«æç¯å½¢é˜Ÿåˆ—ï¼ˆé€šå¸¸ä¸¤è½®ï¼‰                 |
  | *æ•ˆæœ*   | å…¼é¡¾â€œè®¿é—®é¢‘ç‡â€ä¸â€œå†™å…¥æˆæœ¬â€ï¼Œæ€§èƒ½æ¥è¿‘ LRUï¼Œä½†å¼€é”€æ›´ä½ |
]
#three-line-table[
  | ç®—æ³•                 | ä¾æ®            | é¢å¤–æ ‡å¿— | ç‰¹ç‚¹        |
  | ------------------ | ------------- | ---- | --------- |
  | *FIFO*           | è°ƒå…¥é¡ºåº          | æ—     | å®ç°ç®€å•ï¼Œæ€§èƒ½å·®  |
  | *LRU*            | æœ€è¿‘ä½¿ç”¨æ—¶é—´        | éœ€æ—¶é—´æˆ³ | æ€§èƒ½ä¼˜ï¼Œä½†ä»£ä»·å¤§  |
  | *Clock*          | è®¿é—®ä½ A         | 1ä½   | è¿‘ä¼¼ LRU    |
  | *Enhanced Clock* | è®¿é—®ä½ A + ä¿®æ”¹ä½ M | 2ä½   | å‡å°‘å†™å›ï¼Œç³»ç»Ÿå¸¸ç”¨ |
]

=== æœ€ä¸å¸¸ç”¨é¡µé¢ç½®æ¢ç®—æ³• (LFU, Least Frequently Used)

*æœ€ä¸å¸¸ç”¨ç®—æ³•çš„å·¥ä½œåŸç†*
- åŸºæœ¬æ€è·¯
  - ç¼ºé¡µæ—¶ï¼Œç½®æ¢*è®¿é—®æ¬¡æ•°æœ€å°‘*çš„é¡µé¢
- ç®—æ³•å®ç°
  - æ¯ä¸ªé¡µé¢è®¾ç½®ä¸€ä¸ª*è®¿é—®è®¡æ•°*
  - è®¿é—®é¡µé¢æ—¶ï¼Œ*è®¿é—®è®¡æ•°åŠ 1*
  - ç¼ºé¡µæ—¶ï¼Œç½®æ¢*è®¡æ•°æœ€å°çš„é¡µé¢*
*æœ€ä¸å¸¸ç”¨ç®—æ³•ç‰¹å¾*
- ç‰¹å¾
  - ç®—æ³•å¼€é”€å¤§
  - å¼€å§‹æ—¶é¢‘ç¹ä½¿ç”¨ï¼Œä½†ä»¥åä¸ä½¿ç”¨çš„é¡µé¢å¾ˆéš¾ç½®æ¢
    - è§£å†³æ–¹æ³•ï¼šè®¡æ•°å®šæœŸå³ç§»
- LRUå…³æ³¨å¤šä¹…æœªè®¿é—®ï¼Œæ—¶é—´è¶ŠçŸ­è¶Šå¥½
- LFUå…³æ³¨è®¿é—®æ¬¡æ•°ï¼Œæ¬¡æ•°è¶Šå¤šè¶Šå¥½
*LFUç¤ºä¾‹*
- 4ä¸ªç‰©ç†é¡µå¸§ï¼Œæœ€åˆçš„è®¿é—®æ¬¡æ•°a-ï¼8 b-ï¼5 c-ï¼6 d-ï¼2
#figure(
  image("pic/2025-10-24-23-53-21.png", width: 80%),
  numbering: none,
)
#three-line-table[
  | ç‰¹æ€§ | LRU         | LFU              |
  | -- | ----------- | ---------------- |
  | ä¾æ® | æœ€è¿‘ä¸€æ¬¡è®¿é—®çš„æ—¶é—´   | è®¿é—®æ¬¡æ•°             |
  | åå¥½ | æœ€è¿‘è®¿é—®è¿‡çš„é¡µé¢    | ç»å¸¸è¢«è®¿é—®çš„é¡µé¢         |
  | ä¼˜åŠ¿ | é€‚åˆæ—¶é—´å±€éƒ¨æ€§å¼ºçš„ç¨‹åº | é€‚åˆçƒ­ç‚¹æ•°æ®åå¤è®¿é—®çš„ç¨‹åº    |
  | ç¼ºé™· | å¯¹å‘¨æœŸæ€§è®¿é—®æ•æ„Ÿ    | å¯¹é˜¶æ®µæ€§è®¿é—®ä¸æ•æ„Ÿï¼ˆâ€œå†·å´æ…¢â€ï¼‰ |
]

=== Beladyç°è±¡

*Beladyç°è±¡*
- ç°è±¡
  - é‡‡ç”¨FIFOç­‰ç®—æ³•æ—¶ï¼Œå¯èƒ½*å‡ºç°åˆ†é…çš„ç‰©ç†é¡µé¢æ•°å¢åŠ ï¼Œç¼ºé¡µæ¬¡æ•°åè€Œå‡é«˜çš„å¼‚å¸¸ç°è±¡*
- åŸå› 
  - FIFOç®—æ³•çš„ç½®æ¢ç‰¹å¾ä¸è¿›ç¨‹è®¿é—®å†…å­˜çš„åŠ¨æ€ç‰¹å¾*çŸ›ç›¾*
  - è¢«å®ƒç½®æ¢å‡ºå»çš„é¡µé¢*å¹¶ä¸ä¸€å®š*æ˜¯è¿›ç¨‹è¿‘æœŸä¸ä¼šè®¿é—®çš„
- æ€è€ƒ
  - å“ªäº›ç½®æ¢ç®—æ³•æ²¡æœ‰Beladyç°è±¡ï¼Ÿ
    #three-line-table[
      | ç®—æ³•              | æ˜¯å¦ä¼šå‡ºç° Belady ç°è±¡ | åŸå›               |
      | --------------- | --------------- | --------------- |
      | *FIFO*        | âœ… ä¼š             | æŒ‰è¿›å…¥æ—¶é—´æ·˜æ±°ï¼Œä¸è®¿é—®è§„å¾‹ä¸ç¬¦ |
      | *LRU*         | âŒ ä¸ä¼š            | æ»¡è¶³â€œå †æ ˆæ€§è´¨â€        |
      | *OPTï¼ˆæœ€ä¼˜ç®—æ³•ï¼‰*   | âŒ ä¸ä¼š            | ç†è®ºæœ€ä¼˜ï¼Œç¼ºé¡µæ•°æœ€å°‘      |
      | *Clockï¼ˆæ—¶é’Ÿç®—æ³•ï¼‰* | ä¸€èˆ¬ä¸ä¼š            | è¿‘ä¼¼ LRUï¼Œæ»¡è¶³éƒ¨åˆ†å †æ ˆæ€§è´¨ |
      | *æ”¹è¿›çš„ Clock*   | ä¸€èˆ¬ä¸ä¼š            | æ›´æ¥è¿‘ LRU         |
      | *LFU*         | é€šå¸¸ä¸ä¼š            | åŸºäºè®¿é—®é¢‘ç‡ï¼Œéå…ˆè¿›å…ˆå‡ºé€»è¾‘  |
    ]
*FIFOç®—æ³•çš„Beladyç°è±¡*
- è®¿é—®é¡ºåº : `1, 2, 3, 4, 1, 2, 5, 1, 2, 3, 4, 5`
- ç‰©ç†é¡µé¢æ•°: 3 ï¼› ç¼ºé¡µæ¬¡æ•°: 9
  #figure(
    image("pic/2025-10-25-00-04-41.png", width: 80%),
    numbering: none,
  )
- ç‰©ç†é¡µé¢æ•°: 4 ï¼› ç¼ºé¡µæ¬¡æ•°: 10
  #figure(
    image("pic/2025-10-25-00-05-32.png", width: 80%),
    numbering: none,
  )
*LRUç®—æ³•ä¸å­˜åœ¨Beladyç°è±¡*
#figure(
  image("pic/2025-10-25-00-06-14.png", width: 80%),
  numbering: none,
)

*LRUã€FIFOå’ŒClockçš„æ¯”è¾ƒ*
- LRUç®—æ³•å’ŒFIFOæœ¬è´¨ä¸Šéƒ½æ˜¯å…ˆè¿›å…ˆå‡ºçš„æ€è·¯
  - LRUä¾æ®é¡µé¢çš„*æœ€è¿‘è®¿é—®æ—¶é—´æ’åº*
  - LRUéœ€è¦åŠ¨æ€åœ°è°ƒæ•´é¡ºåº
  - FIFOä¾æ®é¡µé¢*è¿›å…¥å†…å­˜çš„æ—¶é—´æ’åº*
  - FIFOçš„é¡µé¢è¿›å…¥æ—¶é—´æ˜¯å›ºå®šä¸å˜çš„
- LRUå¯é€€åŒ–æˆFIFO
  - å¦‚é¡µé¢è¿›å…¥å†…å­˜åæ²¡æœ‰è¢«è®¿é—®ï¼Œæœ€è¿‘è®¿é—®æ—¶é—´ä¸è¿›å…¥å†…å­˜çš„æ—¶é—´ç›¸åŒ
  - ä¾‹å¦‚ï¼šç»™è¿›ç¨‹åˆ†é…3ä¸ªç‰©ç†é¡µé¢ï¼Œé€»è¾‘é¡µé¢çš„è®¿é—®é¡ºåºä¸º1ã€2ã€3ã€4ã€5ã€6ã€1ã€2ã€3â€¦
- LRUç®—æ³•æ€§èƒ½è¾ƒå¥½ï¼Œä½†ç³»ç»Ÿå¼€é”€è¾ƒå¤§
- FIFOç®—æ³•ç³»ç»Ÿå¼€é”€è¾ƒå°ï¼Œä¼šå‘ç”ŸBeladyç°è±¡
- Clockç®—æ³•æ˜¯å®ƒä»¬çš„*æŠ˜è¡·*
  - é¡µé¢è®¿é—®æ—¶ï¼Œä¸åŠ¨æ€è°ƒæ•´é¡µé¢åœ¨é“¾è¡¨ä¸­çš„é¡ºåºï¼Œä»…åšæ ‡è®°
  - ç¼ºé¡µæ—¶ï¼Œå†æŠŠå®ƒç§»åŠ¨åˆ°é“¾è¡¨æœ«å°¾
  - å¯¹äº*æœªè¢«è®¿é—®*çš„é¡µé¢ï¼ŒClockå’ŒLRUç®—æ³•çš„è¡¨ç°ä¸€æ ·å¥½
  - å¯¹äº*è¢«è®¿é—®è¿‡*çš„é¡µé¢ï¼ŒClockç®—æ³•ä¸èƒ½è®°å½•å‡†ç¡®è®¿é—®é¡ºåºï¼Œè€ŒLRUç®—æ³•å¯ä»¥
  #three-line-table[
    | ç®—æ³•        | ä¾æ®     | å¼€é”€ | æ˜¯å¦æœ‰ Belady ç°è±¡ | ç‰¹ç‚¹       |
    | --------- | ------ | -- | ------------- | -------- |
    | *FIFO*  | é¡µé¢è¿›å…¥æ—¶é—´ | å°  | âœ… æœ‰           | å®ç°ç®€å•ï¼Œæ€§èƒ½å·® |
    | *LRU*   | æœ€è¿‘è®¿é—®æ—¶é—´ | å¤§  | âŒ æ—            | æ€§èƒ½å¥½ï¼Œä»£ä»·é«˜  |
    | *Clock* | è®¿é—®ä½æ ‡è®°  | ä¸­  | âŒ æ— ï¼ˆè¿‘ä¼¼ï¼‰       | æŠ˜ä¸­æ–¹æ¡ˆ     |
  ]

== å…¨å±€é¡µé¢ç½®æ¢ç®—æ³•

#note(subname: [é—®é¢˜])[
  å½“ç³»ç»Ÿä¸­æœ‰å¤šä¸ªè¿›ç¨‹åŒæ—¶è¿è¡Œæ—¶ï¼Œå¦‚ä½•ä»å…¨å±€è§’åº¦æ¥åˆ†é…å’Œå›æ”¶ç‰©ç†é¡µå¸§ã€‚æ ¸å¿ƒç›®æ ‡æ˜¯ï¼šåœ¨ä¿è¯ç³»ç»Ÿç¨³å®šè¿è¡Œçš„å‰æä¸‹ï¼Œä½¿ CPU åˆ©ç”¨ç‡æœ€å¤§åŒ–ã€ç¼ºé¡µç‡æœ€å°åŒ–ã€‚

  æœ¬èŠ‚è¦è§£å†³ä¸¤ä¸ªå…³é”®é—®é¢˜
  #three-line-table[
    | é—®é¢˜                              | å«ä¹‰                               |
    | ------------------------------- | -------------------------------- |
    | *æ¯ä¸ªè¿›ç¨‹éœ€è¦å¤šå°‘ç‰©ç†é¡µå¸§ï¼Ÿä½•æ—¶åˆ†é…ï¼Ÿ*      | è‹¥åˆ†é…å¤ªå°‘ï¼Œä¼šé¢‘ç¹ç¼ºé¡µï¼›åˆ†é…å¤ªå¤šï¼Œä¼šæµªè´¹å†…å­˜ã€å½±å“å¹¶å‘ã€‚     |
    | *ä»ç³»ç»Ÿæ•´ä½“è§’åº¦çœ‹ï¼Œåº”å¹¶å‘è¿è¡Œå¤šå°‘ä¸ªè¿›ç¨‹æœ€åˆé€‚ï¼Ÿ* | å¹¶å‘è¿‡å¤šä¼šå¯¼è‡´â€œæŠ–åŠ¨ï¼ˆthrashingï¼‰â€ï¼Œåè€Œé™ä½ç³»ç»Ÿæ•ˆç‡ã€‚ |
  ]
  å±€éƒ¨ç½®æ¢ vs å…¨å±€ç½®æ¢
  #three-line-table[
    | ç±»å‹         | ç½®æ¢èŒƒå›´                  | ç‰¹ç‚¹                  |
    | ---------- | --------------------- | ------------------- |
    | *å±€éƒ¨é¡µé¢ç½®æ¢* | é¡µé¢åªèƒ½åœ¨*æœ¬è¿›ç¨‹*çš„é¡µå¸§å†…ç½®æ¢    | æ¯ä¸ªè¿›ç¨‹ç‹¬ç«‹ç®¡ç†è‡ªå·±çš„é¡µå¸§ï¼Œä¸å½±å“ä»–äºº |
    | *å…¨å±€é¡µé¢ç½®æ¢* | é¡µé¢å¯åœ¨*ç³»ç»Ÿæ‰€æœ‰è¿›ç¨‹çš„é¡µå¸§ä¹‹é—´*ç½®æ¢ | å†…å­˜ç”±å…¨å±€ç»Ÿä¸€åˆ†é…ï¼Œè°éœ€è¦å°±ä»åˆ«äººé‚£æŠ¢ |
  ]
  åœ¨å®é™…ç³»ç»Ÿä¸­ï¼Œæ“ä½œç³»ç»Ÿå¾€å¾€é‡‡ç”¨*â€œå…¨å±€ç½®æ¢ + å±€éƒ¨é™åˆ¶â€*çš„æ··åˆç­–ç•¥ã€‚

  å…³é”®æ€æƒ³ï¼šå·¥ä½œé›†ä¸ç¼ºé¡µç‡æ§åˆ¶
  - å·¥ä½œé›†ç®—æ³•ï¼ˆWorking Set Modelï¼‰
  - ç¼ºé¡µç‡ç®—æ³•ï¼ˆPage Fault Frequency, PFFï¼‰

]

=== å…¨å±€é¡µé¢ç½®æ¢ç®—æ³•çš„å®šä¹‰

*å…¨å±€é¡µé¢ç½®æ¢ç®—æ³•*æ˜¯æŒ‡æ“ä½œç³»ç»Ÿåœ¨å‘ç”Ÿç¼ºé¡µæ—¶ï¼Œå¯ä»¥åœ¨ç³»ç»Ÿæ‰€æœ‰è¿›ç¨‹çš„ç‰©ç†é¡µå¸§ä¸­é€‰æ‹©ä¸€ä¸ªé¡µé¢è¿›è¡Œç½®æ¢ï¼Œè€Œä¸ä»…é™äºå½“å‰è¿›ç¨‹çš„é¡µå¸§èŒƒå›´

*å±€éƒ¨ç½®æ¢ç®—æ³•æ²¡æœ‰è€ƒè™‘è¿›ç¨‹è®¿å­˜å·®å¼‚*
- FIFO é¡µé¢ç½®æ¢ç®—æ³•: å‡è®¾åˆå§‹é¡ºåº a->b->c
- ç‰©ç†é¡µé¢æ•°: 3 ç¼ºé¡µæ¬¡æ•°: 9
  #figure(
    image("pic/2025-10-25-00-19-40.png", width: 80%),
    numbering: none,
  )
- ç‰©ç†é¡µé¢æ•°: 4 ç¼ºé¡µæ¬¡æ•°: 1
  #figure(
    image("pic/2025-10-25-00-22-49.png", width: 80%),
    numbering: none,
  )
*å…¨å±€ç½®æ¢ç®—æ³•çš„å·¥ä½œåŸç†*
- æ€è·¯
  - *ä¸ºè¿›ç¨‹åˆ†é…å¯å˜æ•°ç›®çš„ç‰©ç†é¡µé¢*
    - å½“ç³»ç»Ÿæ£€æµ‹åˆ°æŸä¸ªè¿›ç¨‹ç¼ºé¡µç‡è¿‡é«˜æ—¶ï¼š
      - å¯ä»¥ä»å…¶ä»–è¿›ç¨‹ä¸­æ”¶å›ä¸€éƒ¨åˆ†é¡µå¸§
      - å†åˆ†é…ç»™è¯¥è¿›ç¨‹ï¼Œä»¥æ”¹å–„å…¶æ€§èƒ½
    - å½“ç¼ºé¡µç‡è¾ƒä½æ—¶ï¼š
      - ç³»ç»Ÿå¯å‡å°‘è¯¥è¿›ç¨‹é¡µå¸§æ•°
      - æŠŠèµ„æºè®©ç»™æ›´éœ€è¦çš„è¿›ç¨‹
- å…¨å±€ç½®æ¢ç®—æ³•è¦è§£å†³çš„é—®é¢˜
  - è¿›ç¨‹åœ¨*ä¸åŒé˜¶æ®µ*çš„å†…å­˜éœ€æ±‚æ˜¯å˜åŒ–çš„
  - åˆ†é…ç»™è¿›ç¨‹çš„*å†…å­˜*ä¹Ÿéœ€è¦åœ¨*ä¸åŒé˜¶æ®µæœ‰æ‰€å˜åŒ–*
  - å…¨å±€ç½®æ¢ç®—æ³•éœ€è¦*ç¡®å®šåˆ†é…ç»™è¿›ç¨‹çš„ç‰©ç†é¡µé¢æ•°*

*å…¨å±€ç½®æ¢ç®—æ³•è¦è§£å†³çš„æ ¸å¿ƒé—®é¢˜*
- å¦‚ä½•ç¡®å®šæ¯ä¸ªè¿›ç¨‹æ‰€éœ€çš„é¡µå¸§æ•°ï¼Ÿ
  - ä¸åŒé˜¶æ®µçš„è®¿é—®ç‰¹å¾ä¸åŒï¼ˆå·¥ä½œé›†å¤§å°å˜åŒ–ï¼‰
  - åˆ†é…ç­–ç•¥éœ€éšæ—¶é—´åŠ¨æ€è°ƒæ•´
- ä½•æ—¶ä¸ºè¿›ç¨‹åˆ†é…æˆ–å›æ”¶ç‰©ç†é¡µå¸§ï¼Ÿ
  - æ ¹æ®ç¼ºé¡µç‡ã€å·¥ä½œé›†å˜åŒ–æˆ–ç³»ç»Ÿè´Ÿè½½åŠ¨æ€å†³å®š
- å¦‚ä½•åœ¨ç³»ç»Ÿæ•´ä½“å±‚é¢æé«˜æ•ˆç‡ï¼Ÿ
  - æ—¢è¦ä¿è¯æ¯ä¸ªè¿›ç¨‹æ­£å¸¸è¿è¡Œ
  - åˆè¦é˜²æ­¢ç³»ç»Ÿè¿‡è½½å¯¼è‡´â€œæŠ–åŠ¨ï¼ˆThrashingï¼‰â€

*CPUåˆ©ç”¨ç‡ä¸ç¨‹åºè¿è¡Œæ•°é‡*
- CPUåˆ©ç”¨ç‡ä¸ç¨‹åºè¿è¡Œæ•°é‡å­˜åœ¨ç›¸äº’*ä¿ƒè¿›å’Œåˆ¶çº¦*çš„å…³ç³»
  - è¿è¡Œç¨‹åºå°‘æ—¶ï¼Œæé«˜ç¨‹åºè¿è¡Œæ•°ï¼Œå¯æé«˜CPUåˆ©ç”¨ç‡
  - ç¨‹åºè¿è¡Œæ•°é‡å¤§å¯¼è‡´å†…å­˜è®¿é—®å¢åŠ ï¼Œå¹¶ä¼šé™ä½è®¿å­˜çš„å±€éƒ¨æ€§
  - å±€éƒ¨æ€§ä¸‹é™ä¼šå¯¼è‡´ç¼ºé¡µç‡ä¸Šå‡å’ŒCPUåˆ©ç”¨ç‡ä¸‹é™

  #three-line-table[
    | é˜¶æ®µ   | ç¨‹åºæ•°é‡          | ç³»ç»Ÿè¡¨ç°                             |
    | ---- | ------------- | -------------------------------- |
    | ç¨‹åºè¾ƒå°‘ | CPU æœ‰ç©ºé—²       | âœ… é€‚å½“å¢åŠ å¹¶å‘è¿›ç¨‹ï¼Œå¯æé«˜ CPU åˆ©ç”¨ç‡           |
    | ç¨‹åºè¿‡å¤š | å†…å­˜ç«äº‰ä¸¥é‡        | âš ï¸ è®¿å­˜å±€éƒ¨æ€§ä¸‹é™ï¼Œç¼ºé¡µç‡å‡é«˜ï¼ŒCPU å¤§éƒ¨åˆ†æ—¶é—´ç­‰å¾… I/O |
    | æŠ–åŠ¨çŠ¶æ€ | ç¼ºé¡µé¢‘ç¹ï¼ŒCPU å¿™äºæ¢é¡µ | âŒ CPU åˆ©ç”¨ç‡åè€Œä¸‹é™                    |
  ]

=== å·¥ä½œé›†é¡µé¢ç½®æ¢ç®—æ³•

*å·¥ä½œé›†*
- ä¸€ä¸ªè¿›ç¨‹åœ¨æŸä¸ªæ—¶åˆ»$t$ä¹‹å‰çš„ä¸€æ®µæ—¶é—´ï¼ˆæˆ–è®¿é—®æ¬¡æ•°ï¼‰å†…ï¼Œå®é™…æ­£åœ¨ä½¿ç”¨çš„é€»è¾‘é¡µé¢é›†åˆç§°ä¸ºè¯¥è¿›ç¨‹çš„å·¥ä½œé›†ï¼ˆWorking Setï¼‰ï¼›å¯è¡¨ç¤ºä¸ºäºŒå…ƒå‡½æ•°$W(t, Delta)$
  - å½“å‰æ‰§è¡Œæ—¶åˆ»$t$ï¼š
  - å·¥ä½œé›†çª—å£(working-set window)$Delta$ï¼šä¸€ä¸ªå®šé•¿çš„é¡µé¢è®¿é—®æ—¶é—´çª—å£
  - å·¥ä½œé›†çª—å£$Delta$çš„å¤§å°$tau$
    - æ—¶é—´æ®µé•¿åº¦ï¼Œç”¨å½“å‰æ—¶åˆ»$t$å‰çš„å†…å­˜è®¿é—®æ¬¡æ•°æ¥è¡¨ç¤º
  - å·¥ä½œé›†$W(t, Delta)$
    - åœ¨å½“å‰æ—¶åˆ»$t$å‰çš„$Delta$æ—¶é—´çª—å£ä¸­çš„æ‰€æœ‰è®¿é—®é¡µé¢æ‰€ç»„æˆçš„é›†åˆ
  - å·¥ä½œé›†å¤§å°$abs(W(t, Delta))$
    - å·¥ä½œé›†ä¸­é¡µé¢çš„æ•°é‡

*å·¥ä½œé›†çª—å£çš„æ„ä¹‰*
- $Î”$è¡¨ç¤ºå·¥ä½œé›†çª—å£é•¿åº¦ï¼ˆWorking-Set Windowï¼‰
  - å®ƒæ˜¯ä¸€ä¸ªâ€œæ»‘åŠ¨çª—å£â€ï¼Œè¡¨ç¤ºè¿›ç¨‹åœ¨æœ€è¿‘ $Î”$ æ¬¡è®¿é—®ä¸­ç”¨åˆ°çš„æ‰€æœ‰é¡µé¢
- å·¥ä½œé›†åæ˜ äº†è¿›ç¨‹çš„*å±€éƒ¨æ€§*ç‰¹å¾
  - çª—å£å°ï¼šå·¥ä½œé›†å°ï¼Œä½†å¯èƒ½æ¼æ‰å°šæœªæ¢å‡ºçš„é‡è¦é¡µé¢
  - çª—å£å¤§ï¼šå·¥ä½œé›†å¤§ï¼Œå ç”¨å†…å­˜å¤šï¼Œä½†èƒ½ä¿è¯è¾ƒä½ç¼ºé¡µç‡
- å› æ­¤ $Î”$ çš„å–å€¼éœ€è¦å¹³è¡¡å†…å­˜å¼€é”€ä¸ç¼ºé¡µé¢‘ç‡

*è¿›ç¨‹çš„å·¥ä½œé›†ç¤ºä¾‹*
- ç¤ºä¾‹è®¿é—®åºåˆ—ï¼š
  ```
  2 6 1 5 7 7 7 5 1 6 2 3 4 1 2 3 4 4 4 3 4 4 4 1 3 2 7
                   t1      t2                    t3
  ```
- åœ¨æ—¶åˆ» tâ‚ï¼ŒÎ” = 10
  - å·¥ä½œé›† W(tâ‚, Î”) = {1, 2, 5, 6, 7}
- åœ¨æ—¶åˆ» tâ‚‚ï¼ŒÎ” = 10
  - å·¥ä½œé›† W(tâ‚‚, Î”) = {1, 2, 3, 4, 5, 6, 7}
- åœ¨æ—¶åˆ» tâ‚ƒï¼ŒÎ” = 10
  - å·¥ä½œé›† W(tâ‚ƒ, Î”) = {3, 4}

*å·¥ä½œé›†çš„å˜åŒ–*
- *è¿›ç¨‹å¼€å§‹æ‰§è¡Œ*åï¼Œéšç€è®¿é—®æ–°é¡µé¢é€æ­¥å»ºç«‹è¾ƒç¨³å®šçš„å·¥ä½œé›†
- å½“å†…å­˜è®¿é—®çš„*å±€éƒ¨æ€§åŒºåŸŸä½ç½®å¤§è‡´ç¨³å®š*æ—¶ï¼Œå·¥ä½œé›†å¤§å°ä¹Ÿå¤§è‡´ç¨³å®š
- *å±€éƒ¨æ€§åŒºåŸŸä½ç½®æ”¹å˜*æ—¶ï¼Œå·¥ä½œé›†å¿«é€Ÿæ‰©å¼ å’Œæ”¶ç¼©è¿‡æ¸¡åˆ°ä¸‹ä¸€ä¸ªç¨³å®šå€¼
  #figure(
    image("pic/2025-10-25-00-52-51.png", width: 80%),
    numbering: none,
  )

*å¸¸é©»é›†*
- åœ¨å½“å‰æ—¶åˆ»ï¼Œè¿›ç¨‹*å®é™…é©»ç•™å†…å­˜*ä¸­çš„é¡µé¢é›†åˆ
  #three-line-table[
    | æ¦‚å¿µ      | å«ä¹‰                      |
    | ------- | ----------------------- |
    | *å·¥ä½œé›†* | è¿›ç¨‹åœ¨å½“å‰æ—¶åˆ»æ‰€â€œéœ€è¦â€çš„é¡µé¢é›†åˆï¼ˆç†è®ºéœ€æ±‚ï¼‰ |
    | *å¸¸é©»é›†* | å®é™…åœ¨å†…å­˜ä¸­é©»ç•™çš„é¡µé¢é›†åˆï¼ˆç³»ç»Ÿåˆ†é…ç»“æœï¼‰   |
  ]
- å·¥ä½œé›†ä¸å¸¸é©»é›†çš„å…³ç³»
  - å·¥ä½œé›†æ˜¯è¿›ç¨‹åœ¨è¿è¡Œè¿‡ç¨‹ä¸­çš„*å›ºæœ‰æ€§è´¨*
  - å¸¸é©»é›†*å–å†³äºç³»ç»Ÿåˆ†é…*ç»™è¿›ç¨‹çš„ç‰©ç†é¡µé¢æ•°ç›®å’Œé¡µé¢ç½®æ¢ç®—æ³•
- ç¼ºé¡µç‡ä¸å¸¸é©»é›†çš„å…³ç³»
  - å¸¸é©»é›† âŠ‡ å·¥ä½œé›†æ—¶ï¼Œç¼ºé¡µè¾ƒå°‘
  - å·¥ä½œé›†å‘ç”Ÿå‰§çƒˆå˜åŠ¨ï¼ˆè¿‡æ¸¡ï¼‰æ—¶ï¼Œç¼ºé¡µè¾ƒå¤š
  - è¿›ç¨‹å¸¸é©»é›†å¤§å°è¾¾åˆ°ä¸€å®šæ•°ç›®åï¼Œç¼ºé¡µç‡ä¹Ÿä¸ä¼šæ˜æ˜¾ä¸‹é™

*å·¥ä½œé›†é¡µé¢ç½®æ¢ç®—æ³•*
- æ€è·¯
  - æ¢å‡º*ä¸åœ¨å·¥ä½œé›†ä¸­*çš„é¡µé¢
- å·¥ä½œé›†çª—å£å¤§å°Ï„
  - å½“å‰æ—¶åˆ»å‰Ï„æ¬¡å†…å­˜è®¿é—®çš„é¡µé¢é›†åˆæ„æˆ*å·¥ä½œé›†*
- å®ç°æ–¹æ³•
  - è®¿å­˜é“¾è¡¨ï¼šç»´æŠ¤çª—å£å†…çš„è®¿å­˜é¡µé¢é“¾è¡¨
  - è®¿å­˜æ—¶ï¼Œ*æ¢å‡º*ä¸åœ¨å·¥ä½œé›†çš„é¡µé¢ï¼Œæ›´æ–°è®¿å­˜é“¾è¡¨
  - ç¼ºé¡µæ—¶ï¼Œæ¢å…¥é¡µé¢ï¼Œæ›´æ–°è®¿å­˜é“¾è¡¨

  #three-line-table[
    | æ“ä½œ       | è¯´æ˜                         |
    | -------- | -------------------------- |
    | *è®¿å­˜é“¾è¡¨* | ç»´æŠ¤æœ€è¿‘ Î” æ¬¡è®¿é—®çš„é¡µé¢ï¼ˆæ—¶é—´æœ‰åºï¼‰        |
    | *é¡µé¢è®¿é—®* | è‹¥é¡µé¢åœ¨é“¾è¡¨ä¸­ â†’ æ›´æ–°æ—¶é—´æˆ³ï¼›è‹¥ä¸åœ¨ â†’ åŠ å…¥é“¾è¡¨ |
    | *é¡µé¢ç½®æ¢* | ç¼ºé¡µæ—¶ï¼Œæ¢å‡ºé“¾è¡¨ä¸­ä¸åœ¨å·¥ä½œé›†çª—å£çš„æœ€è€é¡µé¢      |
  ]

*å·¥ä½œé›†ç½®æ¢ç®—æ³•ç¤ºä¾‹*
- $tau = 4$
#figure(
  image("pic/2025-10-25-01-30-21.png", width: 80%),
  numbering: none,
)

#three-line-table[
  | ç‰¹ç‚¹     | è¯´æ˜                 |
  | ------ | ------------------ |
  |  åŠ¨æ€æ€§ | é¡µå¸§æ•°å¯éšæ—¶é—´å˜åŒ–ï¼Œåæ˜ è¿›ç¨‹å®é™…éœ€æ±‚ |
  |  é€‚åº”æ€§ | èƒ½æ ¹æ®å±€éƒ¨æ€§å˜åŒ–è°ƒæ•´åˆ†é…       |
  |  æ•ˆç‡  | ç¼ºé¡µç‡è¾ƒä½ï¼Œç³»ç»Ÿç¨³å®š         |
  |  ç¼ºç‚¹  | éœ€ç»´æŠ¤æ—¶é—´çª—å£ï¼Œç³»ç»Ÿå¼€é”€å¤§      |
]

=== ç¼ºé¡µç‡é¡µé¢ç½®æ¢ç®—æ³•

*ç¼ºé¡µç‡(Page-Fault-Frequency, Page Fault Rate)*
- ç¼ºé¡µæ¬¡æ•° / å†…å­˜è®¿é—®æ¬¡æ•° æˆ– ç¼ºé¡µå¹³å‡æ—¶é—´é—´éš”çš„å€’æ•°
  $
    "PFF" = "ç¼ºé¡µæ¬¡æ•°" / "å†…å­˜è®¿é—®æ¬¡æ•°" = 1 / "ç¼ºé¡µå¹³å‡æ—¶é—´é—´éš”"
  $
  ä¹Ÿå°±æ˜¯è¯´ï¼Œç¼ºé¡µç‡è¶Šé«˜ï¼Œä»£è¡¨ç³»ç»Ÿé¢‘ç¹åœ°å‘ç”Ÿç¼ºé¡µå¼‚å¸¸ï¼Œè¯´æ˜è¿›ç¨‹çš„ç‰©ç†é¡µå¸§ä¸è¶³
- å½±å“ç¼ºé¡µç‡çš„å› ç´ 
  #three-line-table[
    | å› ç´        | è¯´æ˜                           |
    | -------- | ---------------------------- |
    | é¡µé¢ç½®æ¢ç®—æ³•   | ç®—æ³•è¶Šâ€œèªæ˜â€ï¼Œç¼ºé¡µç‡è¶Šä½ï¼ˆå¦‚ LRU ä¼˜äº FIFOï¼‰ |
    | ç‰©ç†é¡µå¸§æ•°    | é¡µå¸§è¶Šå¤šï¼Œèƒ½åŒæ—¶é©»ç•™çš„é¡µé¢è¶Šå¤šï¼Œç¼ºé¡µç‡ä¸‹é™        |
    | é¡µé¢å¤§å°     | é¡µé¢è¿‡å¤§æˆ–è¿‡å°éƒ½ä¼šå½±å“æ¢å…¥æ¢å‡ºçš„æ•ˆç‡           |
    | ç¨‹åºçš„è®¿é—®å±€éƒ¨æ€§ | å±€éƒ¨æ€§å¥½çš„ç¨‹åºç¼ºé¡µç‡è¾ƒä½                 |
  ]

*ç¼ºé¡µç‡ç½®æ¢ç®—æ³•*
- é€šè¿‡è°ƒèŠ‚*å¸¸é©»é›†å¤§å°*ï¼Œä½¿æ¯ä¸ªè¿›ç¨‹çš„ç¼ºé¡µç‡ä¿æŒåœ¨ä¸€ä¸ªåˆç†çš„èŒƒå›´å†…
  - è‹¥è¿›ç¨‹ç¼ºé¡µç‡è¿‡é«˜ï¼Œåˆ™å¢åŠ å¸¸é©»é›†ä»¥åˆ†é…æ›´å¤šçš„ç‰©ç†é¡µé¢
  - è‹¥è¿›ç¨‹ç¼ºé¡µç‡è¿‡ä½ï¼Œåˆ™å‡å°‘å¸¸é©»é›†ä»¥å‡å°‘å®ƒçš„ç‰©ç†é¡µé¢æ•°

*ç¼ºé¡µç‡é¡µé¢ç½®æ¢ç®—æ³•*
- è®¿å­˜æ—¶ï¼Œä¸ºé¡µé¢*è®¾ç½®*â€œå¼•ç”¨ä½æ ‡å¿—â€ï¼ˆReference Bitï¼‰
- ç¼ºé¡µå‘ç”Ÿæ—¶ï¼Œè®°å½•å½“å‰æ—¶é—´`t_current`ï¼Œå¹¶è®¡ç®—ä¸ä¸Šæ¬¡ç¼ºé¡µæ—¶é—´`t_last`çš„é—´éš”ï¼š
  - `t_current - t_last > T`
    - ç½®æ¢æ‰€æœ‰åœ¨`[t_last, t_current]`æ—¶é—´å†…æ²¡æœ‰è¢«å¼•ç”¨çš„é¡µ
  - `t_current - t_last < T`
    - åˆ™å¢åŠ ç¼ºå¤±é¡µåˆ°å¸¸é©»é›†ä¸­

*ç¼ºé¡µç‡ç½®æ¢ç®—æ³•ç¤ºä¾‹*
- å‡å®šçª—å£å¤§å°ä¸º 2
#figure(
  image("pic/2025-10-25-01-45-10.png", width: 80%),
  numbering: none,
)

#three-line-table[
  | ç‰¹ç‚¹      | è¯´æ˜                |
  | ------- | ----------------- |
  | åŠ¨æ€è°ƒæ•´ | ä¾æ®ç¼ºé¡µé—´éš”ï¼Œè‡ªåŠ¨å¢åŠ æˆ–å‡å°‘é¡µå¸§æ•° |
  | ç²¾ç¡®æ§åˆ¶ | ç»´æŒç¼ºé¡µç‡åœ¨ç†æƒ³åŒºé—´        |
  | å®ç°ç®€å• | ä»…éœ€è®°å½•â€œç¼ºé¡µæ—¶é—´é—´éš”â€      |
  | ç¼ºç‚¹   | ä¸èƒ½ç²¾ç¡®åæ˜ å·¥ä½œé›†å˜åŒ–ï¼Œååº”æ»å  |
]

#newpara()
*PFF ä¸å·¥ä½œé›†ç®—æ³•çš„æ¯”è¾ƒ*
- #three-line-table[
    | å¯¹æ¯”é¡¹ç›® | å·¥ä½œé›†ç®—æ³•       | ç¼ºé¡µç‡ç®—æ³•   |
    | ---- | ----------- | ------- |
    | ä¾æ®æŒ‡æ ‡ | æ—¶é—´çª—å£å†…çš„è®¿é—®é¡µé›†åˆ | ç¼ºé¡µæ—¶é—´é—´éš”  |
    | è°ƒæ•´æ–¹å¼ | ç»´æŠ¤å·¥ä½œé›†é›†åˆ     | è°ƒæ•´å¸¸é©»é›†å¤§å° |
    | å®ç°å¼€é”€ | è¾ƒå¤§ï¼ˆéœ€æ—¶é—´æˆ³æ”¯æŒï¼‰  | è¾ƒå°      |
    | ç²¾ç¡®åº¦  | é«˜ï¼Œèƒ½åæ˜ å±€éƒ¨æ€§å˜åŒ–  | ç›¸å¯¹æ»å    |
    | é€‚ç”¨åœºæ™¯ | ç²¾åº¦è¦æ±‚é«˜çš„ç³»ç»Ÿ    | å®æ—¶è°ƒèŠ‚å‹ç³»ç»Ÿ |
  ]

*æŠ–åŠ¨é—®é¢˜(thrashing)*
- æŠ–åŠ¨
  - è¿›ç¨‹*ç‰©ç†é¡µé¢å¤ªå°‘*ï¼Œä¸èƒ½åŒ…å«å·¥ä½œé›†
  - é€ æˆ*å¤§é‡ç¼ºé¡µ*ï¼Œé¢‘ç¹ç½®æ¢
  - è¿›ç¨‹*è¿è¡Œé€Ÿåº¦å˜æ…¢*
- äº§ç”ŸæŠ–åŠ¨çš„åŸå› 
  - éšç€é©»ç•™å†…å­˜çš„*è¿›ç¨‹æ•°ç›®*å¢åŠ ï¼Œåˆ†é…ç»™æ¯ä¸ªè¿›ç¨‹çš„ç‰©ç†é¡µé¢æ•°ä¸æ–­å‡å°ï¼Œç¼ºé¡µç‡ä¸æ–­ä¸Šå‡
- æ“ä½œç³»ç»Ÿéœ€åœ¨*å¹¶å‘æ°´å¹³å’Œç¼ºé¡µç‡ä¹‹é—´è¾¾åˆ°ä¸€ä¸ªå¹³è¡¡*
  - é€‰æ‹©ä¸€ä¸ªé€‚å½“çš„è¿›ç¨‹æ•°ç›®å’Œè¿›ç¨‹éœ€è¦çš„ç‰©ç†é¡µé¢æ•°

#note(subname: [å°ç»“])[
  - å…¨å±€é¡µé¢ç½®æ¢ç®—æ³•æŠŠæ‰€æœ‰è¿›ç¨‹è§†ä¸ºæ•´ä½“æ¥è®¾ç½®é¡µé¢ç½®æ¢ç®—æ³•
    - å·¥ä½œé›†ç½®æ¢ç®—æ³•ã€ç¼ºé¡µç‡ç½®æ¢ç®—æ³•
  - å„å±‚æ¬¡å­˜å‚¨ä»‹è´¨å‡è¡¡ç¹å¿™æ—¶ï¼Œå­˜å‚¨ç³»ç»Ÿæ•´ä½“åˆ©ç”¨ç‡æœ€é«˜
]
